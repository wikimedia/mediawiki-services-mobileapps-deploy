{"version":3,"sources":["webpack://pagelib/webpack/universalModuleDefinition","webpack://pagelib/webpack/bootstrap","webpack://pagelib/./src/transform/Polyfill.js","webpack://pagelib/./src/transform/ElementUtilities.js","webpack://pagelib/./src/transform/CollapseTable.js","webpack://pagelib/./src/transform/SectionUtilities.ts","webpack://pagelib/./src/transform/NodeUtilities.js","webpack://pagelib/./src/transform/LazyLoadTransform.ts","webpack://pagelib/./src/transform/Throttle.js","webpack://pagelib/./src/transform/FooterContainer.js","webpack://pagelib/./src/transform/FooterLegal.js","webpack://pagelib/./src/transform/CollectionUtilities.js","webpack://pagelib/./src/transform/FooterReadMore.js","webpack://pagelib/./src/transform/ElementGeometry.js","webpack://pagelib/./src/transform/EditTransform.js","webpack://pagelib/./src/transform/PlatformTransform.js","webpack://pagelib/./src/transform/ThemeTransform.js","webpack://pagelib/./src/transform/FooterMenu.js","webpack://pagelib/./src/transform/ReferenceCollection.js","webpack://pagelib/./src/transform/AdjustTextSize.ts","webpack://pagelib/./src/transform/BodySpacingTransform.ts","webpack://pagelib/./src/transform/DimImagesTransform.js","webpack://pagelib/./src/transform/LazyLoadTransformer.js","webpack://pagelib/./src/pcs/c1/Footer.js","webpack://pagelib/./src/pcs/c1/L10N.js","webpack://pagelib/./src/pcs/c1/Scroller.js","webpack://pagelib/./src/pcs/index.js","webpack://pagelib/./src/pcs/c1/index.js","webpack://pagelib/./src/pcs/c1/InteractionHandling.js","webpack://pagelib/./src/pcs/c1/Page.js","webpack://pagelib/./src/pcs/c1/Platforms.js","webpack://pagelib/./src/pcs/c1/Sections.js","webpack://pagelib/./src/pcs/c1/Themes.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","CustomEvent","window","type","parameters","arguments","length","undefined","bubbles","cancelable","detail","event","document","createEvent","initCustomEvent","matchesSelector","el","selector","matches","webkitMatchesSelector","querySelectorAll","element","Array","slice","_Polyfill","findClosestAncestor","parentElement","Polyfill","isNestedInTable","Boolean","closestInlineStyle","thisValue","style","isVisible","offsetWidth","offsetHeight","getClientRects","copyAttributesToDataAttributes","source","destination","attributes","filter","attribute","hasAttribute","forEach","setAttribute","getAttribute","copyDataAttributesToAttributes","NODE_TYPE","NodeUtilities","CLASS","ICON","CONTAINER","COLLAPSED_CONTAINER","COLLAPSED","COLLAPSED_BOTTOM","COLLAPSE_TEXT","EXPANDED","TABLE_INFOBOX","TABLE_OTHER","isHeaderEligible","header","childNodes","isHeaderTextEligible","headerText","replace","firstWordFromString","string","match","isNodeTextContentSimilarToPageTitle","node","pageTitle","firstPageTitleWord","firstNodeTextContentWord","textContent","toLowerCase","stringWithNormalizedWhitespace","trim","isNodeBreakElement","nodeType","ELEMENT_NODE","tagName","replaceNodeWithBreakingSpaceTextNode","parentNode","replaceChild","createTextNode","extractEligibleHeaderText","fragment","createDocumentFragment","appendChild","cloneNode","fragmentHeader","querySelector","remove","childNodesArray","isNodeTypeElementOrText","elementScopeComparator","a","b","aHasScope","bHasScope","getTableHeaderTextArray","headerTextArray","headers","sort","indexOf","push","toggleCollapsedForContainer","container","trigger","footerDivClickCallback","children","table","footer","caption","collapsed","display","classList","add","visibility","toggleCollapseClickCallback","shouldTableBeCollapsed","blacklistIntersects","some","clazz","contains","isInfobox","newCollapsedHeaderDiv","content","div","createElement","newCollapsedFooterDiv","innerHTML","newCaptionFragment","title","titleClass","strong","span","replaceNodeInSection","nodeToReplace","replacementNode","childOfSectionTag","sectionTag","foundSectionTag","SectionUtilities","isMediaWikiSectionElement","insertBefore","removeChild","prepareTables","infoboxTitle","otherTitle","footerTitle","tables","ElementUtilities","captionFragment","containerDiv","className","marginTop","marginBottom","collapsedHeaderDiv","collapsedFooterDiv","toggleCollapsedForAll","setupEventHandling","isInitiallyCollapsed","dispatchSectionToggledEvent","dispatchEvent","onclick","adjustTables","isMainPage","SECTION_TOGGLED_EVENT_TYPE","collapseTables","expandCollapsedTableIfItContainsElement","containerSelector","collapsedDiv","firstElementChild","click","test","default","getSectionIDOfElement","section","current","getSectionOfElement","id","getLeadParagraphText","firstParagaphInASection","innerText","getSectionOffsets","body","sections","from","reduce","results","heading","parseInt","yOffset","offsetTop","TEXT_NODE","ElementGeometry","CLASSES","PLACEHOLDER_CLASS","PLACEHOLDER_PENDING_CLASS","PLACEHOLDER_LOADING_CLASS","PLACEHOLDER_ERROR_CLASS","IMAGE_LOADING_CLASS","IMAGE_LOADED_CLASS","COPY_ATTRIBUTES","UNIT_TO_MINIMUM_LAZY_LOAD_SIZE","px","ex","em","queryLazyLoadableImages","image","geometry","width","height","minWidth","widthUnit","Infinity","minHeight","heightUnit","widthValue","heightValue","isLazyLoadable","convertImagesToPlaceholders","images","map","placeholder","setProperty","spacing","ratio","convertImageToPlaceholder","loadPlaceholder","retryListener","stopPropagation","preventDefault","addEventListener","removeEventListener","once","Throttle","period","funktion","_classCallCheck","_window","_period","_function","_context","_arguments","_result","_timeout","_timestamp","throttle","throttled","queue","result","pending","delay","cancel","reset","context","args","_this","setTimeout","Date","now","apply","Math","max","clearTimeout","containerFragment","menuSection","readMoreSection","legalSection","isContainerAttached","licenseString","licenseSubstitutionString","containerID","licenseLinkClickHandler","viewInBrowserString","browserLinkClickHandler","licenseStringHalves","split","collectPageIssues","collectDisambiguationTitles","href","collectDisambiguationHTML","collectPageIssuesHTML","collectPageIssuesText","safelyRemoveEnclosures","opener","closer","enclosureRegex","RegExp","counter","stringToClean","previousString","cleanExtract","ReadMorePage","displayTitle","thumbnail","description","extract","showReadMorePages","pages","saveButtonClickHandler","titlesShownHandler","shownTitles","getElementById","page","index","titles","normalized","pageFragment","readMorePage","outerAnchorContainer","backgroundImage","innerDivContainer","encodeURI","titleToShow","descriptionEl","saveButton","documentFragmentForReadMorePage","fetchErrorHandler","statusText","console","log","count","baseURL","showReadMorePagesHandler","xhr","XMLHttpRequest","open","readMoreQueryURL","onload","readyState","DONE","status","JSON","parse","responseText","rand","floor","random","onerror","send","error","toString","fetchReadMore","setHeading","headingString","headingID","headingElement","updateSaveButtonForTitle","text","isSaved","button","unfilledClass","filledClass","updateSaveButtonBookmarkIcon","DimensionUnit","unit","_value","Number","_unit","getPropertyValue","fromStyle","isNaN","_width","_height","fromElement","NaN","SECTION_HEADER","TITLE","LINK_CONTAINER","LINK","PROTECTION","UNPROTECTED","PROTECTED","FORBIDDEN","IDS","DATA_ATTRIBUTE","newEditSectionButton","link","newEditSectionLink","newEditSectionHeader","level","titleHTML","showEditPencil","titleDescriptionElements","titleDescription","addTitleDescriptionString","isTitleDescriptionEditable","ADD_TITLE_DESCRIPTION","setEditButtons","isEditable","isProtected","documentElement","newEditLeadSectionHeader","pageDisplayTitle","hasPronunciation","descriptionElements","divider","ANDROID","IOS","classify","html","navigator","userAgent","isAndroid","isIOs","setPlatform","platform","CONSTRAINT","IMAGE_PRESUMES_WHITE_BACKGROUND","DIV_DO_NOT_APPLY_BASELINE","THEME","DEFAULT","DARK","SEPIA","BLACK","footballTemplateImageFilenameRegex","imagePresumesWhiteBackground","src","setTheme","theme","classifyElements","join","_CollectionUtilities","MenuItemType","languages","lastEdited","pageIssues","disambiguation","coordinate","talkPage","referenceList","MenuItem","subtitle","itemType","clickHandler","payload","CollectionUtilities","_","maybeAddItem","item","extractor","payloadExtractor","menuItem","containerAnchor","iconClass","documentFragmentForMenuItem","addItem","isCitation","isWhitespaceTextNode","Node","hasCitationLink","anchor","hash","getRefTextContainer","refTextContainerID","decodeURIComponent","collectRefText","refTextContainer","frag","fragDiv","closestReferenceClassElement","sourceNode","ReferenceItem","rect","ReferenceLinkItem","NearbyReferences","selectedIndex","referencesGroup","adjacentNonWhitespaceNode","siblingGetter","currentNode","collectAdjacentReferenceNodes","nodeCollector","prevSiblingGetter","previousSibling","nextSiblingGetter","nextSibling","collectNearbyReferenceNodes","collectedNodes","unshift","collectNearbyReferences","sourceNodeParent","referenceNodes","getBoundingClientRect","top","right","bottom","left","x","y","getBoundingClientRectAsPlainObject","referenceItemForNode","collectNearbyReferencesAsText","referenceLinkItemForNode","setPercentage","textSize","setMargins","bodyElement","values","marginRight","marginLeft","setPadding","paddingTop","paddingRight","paddingBottom","paddingLeft","dimImages","enable","areImagesDimmed","dim","isDim","EVENT_TYPES","CollapseTable","THROTTLE_PERIOD_MILLISECONDS","_class","loadDistanceMultiplier","_loadDistanceMultiplier","_placeholders","_registered","_throttledLoadPlaceholders","wrap","_loadPlaceholders","LazyLoadTransform","placeholders","concat","_register","_this2","eventType","_this3","_this4","_isPlaceholderEligibleToLoad","deregister","_isPlaceholderWithinLoadDistance","bounds","range","innerHeight","handlers","FooterMenu","params","articleTitle","menuItems","l10n","_params$readMore","readMore","readMoreItemCount","itemCount","readMoreBaseURL","FooterContainer","menuHeading","menuItemTypeString","menuLanguagesTitle","menuLastEditedTitle","menuLastEditedSubtitle","menuPageIssuesTitle","menuDisambiguationTitle","menuCoordinateTitle","menuTalkPageTitle","menuReferenceListTitle","footerItemSelected","FooterReadMore","readMoreHeading","saveOtherPage","titlesRetrieved","FooterLegal","viewLicense","viewInBrowser","updateReadMoreSaveButtonForTitle","_connectHandlers","newHandlers","selectors","addTitleDescription","EditTransform","tableInfobox","tableOther","tableClose","localizeLabels","localizedStrings","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","entries","iterator","next","done","_ref","_ref2","_slicedToArray","elements","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","err","return","scrollTop","setScrollTop","newValue","scrollWithDecorOffset","scrollTo","testing","getScrollTop","_c","c1","Footer","InteractionHandling","L10N","Platforms","Page","Scroller","Sections","Themes","Actions","LinkClicked","ImageClicked","ReferenceClicked","EditSection","AddTitleDescription","PronunciationClicked","FooterItemSelected","SaveOtherPage","ReadMoreTitlesRetrieved","ViewLicense","ViewInBrowser","interactionHandler","Interaction","action","data","ItemType","ClickedItem","target","ReferenceCollection","closest","postMessage","interaction","canonicalFileHref","postMessageForClickedItem","substring","canonicalHref","data-file-width","data-file-height","postMessageForImage","innerPlaceholderSpan","outerSpan","postMessageForImagePlaceholder","nearbyReferences","postMessageForReferenceWithTarget","getSelectionInfo","optionalWindow","selection","getSelection","anchorNode","isTitleDescription","setInteractionHandler","myHandlerFunction","anchorForTarget","sectionId","handleClickEvent","onPageLoad","setup","optionalSettings","onSuccess","settings","PlatformTransform","ThemeTransform","DimImagesTransform","margins","BodySpacingTransform","areTablesInitiallyExpanded","textSizeAdjustmentPercentage","AdjustTextSize","loadImages","lazyLoader","LazyLoadTransformer","collectExistingPlaceholders","loadPlaceholders","Function","requestAnimationFrame","setDimImages","setTextSizeAdjustmentPercentage","getRevision","about","lastIndexOf","getScroller","_PlatformTransform","_SectionUtilities","getOffsets","_ThemeTransform"],"mappings":"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","file":"wikimedia-page-library-pcs.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"pagelib\"] = factory();\n\telse\n\t\troot[\"pagelib\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 33);\n","/**\n * Polyfill function that tells whether a given element matches a selector.\n * @param {!Element} el Element\n * @param {!string} selector Selector to look for\n * @return {!boolean} Whether the element matches the selector\n */\nconst matchesSelector = (el, selector) => {\n  if (el.matches) {\n    return el.matches(selector)\n  }\n  if (el.matchesSelector) {\n    return el.matchesSelector(selector)\n  }\n  if (el.webkitMatchesSelector) {\n    return el.webkitMatchesSelector(selector)\n  }\n  return false\n}\n\n/**\n * @param {!Element} element\n * @param {!string} selector\n * @return {!Array.<Element>}\n */\nconst querySelectorAll = (element, selector) =>\n  Array.prototype.slice.call(element.querySelectorAll(selector))\n\n// https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n// Required by Android API 16 AOSP Nexus S emulator.\n// eslint-disable-next-line no-undef\nconst CustomEvent = typeof window !== 'undefined' && window.CustomEvent\n  || function(type, parameters = { bubbles: false, cancelable: false, detail: undefined }) {\n    // eslint-disable-next-line no-undef\n    const event = document.createEvent('CustomEvent')\n    event.initCustomEvent(type, parameters.bubbles, parameters.cancelable, parameters.detail)\n    return event\n  }\n\nexport default {\n  matchesSelector,\n  querySelectorAll,\n  CustomEvent\n}","import Polyfill from './Polyfill'\n\n// todo: drop ancestor consideration and move to Polyfill.closest().\n/**\n * Returns closest ancestor of element which matches selector.\n * Similar to 'closest' methods as seen here:\n *  https://api.jquery.com/closest/\n *  https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n * @param  {!Element} el        Element\n * @param  {!string} selector   Selector to look for in ancestors of 'el'\n * @return {?HTMLElement}       Closest ancestor of 'el' matching 'selector'\n */\nconst findClosestAncestor = (el, selector) => {\n  let parentElement\n  for (parentElement = el.parentElement;\n    parentElement && !Polyfill.matchesSelector(parentElement, selector);\n    parentElement = parentElement.parentElement) {\n    // Intentionally empty.\n  }\n  return parentElement\n}\n\n/**\n * @param {?Element} element\n * @param {!string} property\n * @param {?string} value\n * @return {?Element} The inclusive first element with an inline style (and optional value) or\n * undefined.\n */\nconst closestInlineStyle = (element, property, value) => {\n  for (let el = element; el; el = el.parentElement) {\n    const thisValue = el.style[property]\n    if (thisValue) {\n      if (value === undefined) {\n        return el\n      }\n      if (value === thisValue) {\n        return el\n      }\n    }\n  }\n  return undefined\n}\n\n/**\n * Determines if element has a table ancestor.\n * @param  {!Element}  el   Element\n * @return {!boolean}       Whether table ancestor of 'el' is found\n */\nconst isNestedInTable = el => Boolean(findClosestAncestor(el, 'table'))\n\n/**\n * @param {!HTMLElement} element\n * @return {!boolean} true if element affects layout, false otherwise.\n */\nconst isVisible = element =>\n  // https://github.com/jquery/jquery/blob/305f193/src/css/hiddenVisibleSelectors.js#L12\n  Boolean(element.offsetWidth || element.offsetHeight || element.getClientRects().length)\n\n/**\n * Copy existing attributes from source to destination as data-* attributes.\n * @param {!HTMLElement} source\n * @param {!HTMLElement} destination\n * @param {!Array.<string>} attributes\n * @return {void}\n */\nconst copyAttributesToDataAttributes = (source, destination, attributes) => {\n  attributes.filter(attribute => source.hasAttribute(attribute))\n    .forEach(attribute =>\n      destination.setAttribute(`data-${attribute}`, source.getAttribute(attribute)))\n}\n\n/**\n * Copy existing data-* attributes from source to destination as attributes.\n * @param {!HTMLElement} source\n * @param {!HTMLElement} destination\n * @param {!Array.<string>} attributes\n * @return {void}\n */\nconst copyDataAttributesToAttributes = (source, destination, attributes) => {\n  attributes.filter(attribute => source.hasAttribute(`data-${attribute}`))\n    .forEach(attribute =>\n      destination.setAttribute(attribute, source.getAttribute(`data-${attribute}`)))\n}\n\nexport default {\n  findClosestAncestor,\n  isNestedInTable,\n  closestInlineStyle,\n  isVisible,\n  copyAttributesToDataAttributes,\n  copyDataAttributesToAttributes\n}","import './CollapseTable.css'\nimport ElementUtilities from './ElementUtilities'\nimport NodeUtilities from './NodeUtilities'\nimport Polyfill from './Polyfill'\nimport SectionUtilities from './SectionUtilities'\n\nconst NODE_TYPE = NodeUtilities.NODE_TYPE\n\nconst SECTION_TOGGLED_EVENT_TYPE = 'section-toggled'\nconst BREAKING_SPACE = ' '\nconst CLASS = {\n  ICON: 'pagelib_collapse_table_icon',\n  CONTAINER: 'pagelib_collapse_table_container',\n  COLLAPSED_CONTAINER: 'pagelib_collapse_table_collapsed_container',\n  COLLAPSED: 'pagelib_collapse_table_collapsed',\n  COLLAPSED_BOTTOM: 'pagelib_collapse_table_collapsed_bottom',\n  COLLAPSE_TEXT: 'pagelib_collapse_table_collapse_text',\n  EXPANDED: 'pagelib_collapse_table_expanded',\n  TABLE_INFOBOX: 'pagelib_table_infobox',\n  TABLE_OTHER: 'pagelib_table_other'\n}\n\n/**\n * Determine if we want to extract text from this header.\n * @param {!Element} header\n * @return {!boolean}\n */\nconst isHeaderEligible =\n  header => header.childNodes && Polyfill.querySelectorAll(header, 'a').length < 3\n\n/**\n * Determine eligibility of extracted text.\n * @param {?string} headerText\n * @return {!boolean}\n */\nconst isHeaderTextEligible = headerText =>\n  headerText && headerText.replace(/[\\s0-9]/g, '').length > 0\n\n/**\n * Extracts first word from string. Returns null if for any reason it is unable to do so.\n * @param  {!string} string\n * @return {?string}\n */\nconst firstWordFromString = string => {\n  // 'If the global flag (g) is not set, Element zero of the array contains the entire match,\n  // while elements 1 through n contain any submatches.'\n  const matches = string.match(/\\w+/) // Only need first match so not using 'g' option.\n  if (!matches) {\n    return undefined\n  }\n  return matches[0]\n}\n\n/**\n * Is node's textContent too similar to pageTitle. Checks if the first word of the node's\n * textContent is found at the beginning of pageTitle.\n * @param  {!Node} node\n * @param  {!string} pageTitle\n * @return {!boolean}\n */\nconst isNodeTextContentSimilarToPageTitle = (node, pageTitle) => {\n  const firstPageTitleWord = firstWordFromString(pageTitle)\n  const firstNodeTextContentWord = firstWordFromString(node.textContent)\n  // Don't claim similarity if 1st words were not extracted.\n  if (!firstPageTitleWord || !firstNodeTextContentWord) {\n    return false\n  }\n  return firstPageTitleWord.toLowerCase() === firstNodeTextContentWord.toLowerCase()\n}\n\n/**\n * Removes leading and trailing whitespace and normalizes other whitespace - i.e. ensures\n * non-breaking spaces, tabs, etc are replaced with regular breaking spaces.\n * @param  {!string} string\n * @return {!string}\n */\nconst stringWithNormalizedWhitespace = string => string.trim().replace(/\\s/g, BREAKING_SPACE)\n\n/**\n * Determines if node is a BR.\n * @param  {!Node}  node\n * @return {!boolean}\n */\nconst isNodeBreakElement = node => node.nodeType === NODE_TYPE.ELEMENT_NODE && node.tagName === 'BR'\n\n/**\n * Replace node with a text node bearing a single breaking space.\n * @param {!Document} document\n * @param  {!Node} node\n * @return {void}\n */\nconst replaceNodeWithBreakingSpaceTextNode = (document, node) => {\n  node.parentNode.replaceChild(document.createTextNode(BREAKING_SPACE), node)\n}\n\n/**\n * Extracts any header text determined to be eligible.\n * @param {!Document} document\n * @param {!Element} header\n * @param {?string} pageTitle\n * @return {?string}\n */\nconst extractEligibleHeaderText = (document, header, pageTitle) => {\n  if (!isHeaderEligible(header)) {\n    return null\n  }\n  // Clone header into fragment. This is done so we can remove some elements we don't want\n  // represented when \"textContent\" is used. Because we've cloned the header into a fragment, we are\n  // free to strip out anything we want without worrying about affecting the visible document.\n  const fragment = document.createDocumentFragment()\n  fragment.appendChild(header.cloneNode(true))\n  const fragmentHeader = fragment.querySelector('th')\n\n  Polyfill.querySelectorAll(\n    fragmentHeader, '.geo, .coordinates, sup.reference, ol, ul, style, script'\n  ).forEach(el => el.remove())\n\n  const childNodesArray = Array.prototype.slice.call(fragmentHeader.childNodes)\n  if (pageTitle) {\n    childNodesArray\n      .filter(NodeUtilities.isNodeTypeElementOrText)\n      .filter(node => isNodeTextContentSimilarToPageTitle(node, pageTitle))\n      .forEach(node => node.remove())\n  }\n\n  childNodesArray\n    .filter(isNodeBreakElement)\n    .forEach(node => replaceNodeWithBreakingSpaceTextNode(document, node))\n\n  const headerText = fragmentHeader.textContent\n  if (isHeaderTextEligible(headerText)) {\n    return stringWithNormalizedWhitespace(headerText)\n  }\n  return null\n}\n\n/**\n * Used to sort array of Elements so those containing 'scope' attribute are moved to front of\n * array. Relative order between 'scope' elements is preserved. Relative order between non 'scope'\n * elements is preserved.\n * @param  {!Element} a\n * @param  {!Element} b\n * @return {!number}\n */\nconst elementScopeComparator = (a, b) => {\n  const aHasScope = a.hasAttribute('scope')\n  const bHasScope = b.hasAttribute('scope')\n  if (aHasScope && bHasScope) {\n    return 0\n  }\n  if (aHasScope) {\n    return -1\n  }\n  if (bHasScope) {\n    return 1\n  }\n  return 0\n}\n\n/**\n * Find an array of table header (TH) contents. If there are no TH elements in\n * the table or the header's link matches pageTitle, an empty array is returned.\n * @param {!Document} document\n * @param {!Element} element\n * @param {?string} pageTitle Unencoded page title; if this title matches the\n *                            contents of the header exactly, it will be omitted.\n * @return {!Array<string>}\n */\nconst getTableHeaderTextArray = (document, element, pageTitle) => {\n  const headerTextArray = []\n  const headers = Polyfill.querySelectorAll(element, 'th')\n  headers.sort(elementScopeComparator)\n  for (let i = 0; i < headers.length; ++i) {\n    const headerText = extractEligibleHeaderText(document, headers[i], pageTitle)\n    if (headerText && headerTextArray.indexOf(headerText) === -1) {\n      headerTextArray.push(headerText)\n      // 'newCaptionFragment' only ever uses the first 2 items.\n      if (headerTextArray.length === 2) {\n        break\n      }\n    }\n  }\n  return headerTextArray\n}\n\n/**\n * @typedef {function} FooterDivClickCallback\n * @param {!HTMLElement}\n * @return {void}\n */\n\n/**\n * @param {!Element} container div\n * @param {?Element} trigger element that was clicked or tapped\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {boolean} true if collapsed, false if expanded.\n */\nconst toggleCollapsedForContainer = function(container, trigger, footerDivClickCallback) {\n  const header = container.children[0]\n  const table = container.children[1]\n  const footer = container.children[2]\n  const caption = header.querySelector('.app_table_collapsed_caption')\n  const collapsed = table.style.display !== 'none'\n  if (collapsed) {\n    table.style.display = 'none'\n    header.classList.remove(CLASS.COLLAPSED)\n    header.classList.remove(CLASS.ICON)\n    header.classList.add(CLASS.EXPANDED)\n    if (caption) {\n      caption.style.visibility = 'visible'\n    }\n    footer.style.display = 'none'\n    // if they clicked the bottom div, then scroll back up to the top of the table.\n    if (trigger === footer && footerDivClickCallback) {\n      footerDivClickCallback(container)\n    }\n  } else {\n    table.style.display = 'block'\n    header.classList.remove(CLASS.EXPANDED)\n    header.classList.add(CLASS.COLLAPSED)\n    header.classList.add(CLASS.ICON)\n    if (caption) {\n      caption.style.visibility = 'hidden'\n    }\n    footer.style.display = 'block'\n  }\n  return collapsed\n}\n\n/**\n * Ex: toggleCollapseClickCallback.bind(el, (container) => {\n *       window.scrollTo(0, container.offsetTop - transformer.getDecorOffset())\n *     })\n * @this HTMLElement\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {boolean} true if collapsed, false if expanded.\n */\nconst toggleCollapseClickCallback = function(footerDivClickCallback) {\n  const container = this.parentNode\n  return toggleCollapsedForContainer(container, this, footerDivClickCallback)\n}\n\n/**\n * @param {!HTMLElement} table\n * @return {!boolean} true if table should be collapsed, false otherwise.\n */\nconst shouldTableBeCollapsed = table => {\n  const classBlacklist = ['navbox', 'vertical-navbox', 'navbox-inner', 'metadata', 'mbox-small']\n  const blacklistIntersects = classBlacklist.some(clazz => table.classList.contains(clazz))\n  return table.style.display !== 'none' && !blacklistIntersects\n}\n\n/**\n * @param {!Element} element\n * @return {!boolean} true if element is an infobox, false otherwise.\n */\nconst isInfobox = element =>\n  element.classList.contains('infobox')\n  || element.classList.contains('infobox_v3')\n\n/**\n * @param {!Document} document\n * @param {!DocumentFragment} content\n * @return {!HTMLDivElement}\n */\nconst newCollapsedHeaderDiv = (document, content) => {\n  const div = document.createElement('div')\n  div.classList.add(CLASS.COLLAPSED_CONTAINER)\n  div.classList.add(CLASS.EXPANDED)\n  div.appendChild(content)\n  return div\n}\n\n/**\n * @param {!Document} document\n * @param {?string} content HTML string.\n * @return {!HTMLDivElement}\n */\nconst newCollapsedFooterDiv = (document, content) => {\n  const div = document.createElement('div')\n  div.classList.add(CLASS.COLLAPSED_BOTTOM)\n  div.classList.add(CLASS.ICON)\n  div.innerHTML = content || ''\n  return div\n}\n\n/**\n * @param {!Document} document\n * @param {!string} title\n * @param {!string} titleClass\n * @param {!Array.<string>} headerText\n * @return {!DocumentFragment}\n */\nconst newCaptionFragment = (document, title, titleClass, headerText) => {\n  const fragment = document.createDocumentFragment()\n\n  const strong = document.createElement('strong')\n  strong.innerHTML = title\n  strong.classList.add(titleClass)\n  fragment.appendChild(strong)\n\n  const span = document.createElement('span')\n  span.classList.add(CLASS.COLLAPSE_TEXT)\n  if (headerText.length > 0) {\n    span.appendChild(document.createTextNode(`: ${headerText[0]}`))\n  }\n  if (headerText.length > 1) {\n    span.appendChild(document.createTextNode(`, ${headerText[1]}`))\n  }\n  if (headerText.length > 0) {\n    span.appendChild(document.createTextNode(' …'))\n  }\n  fragment.appendChild(span)\n\n  return fragment\n}\n\n/**\n * @param {!Node} nodeToReplace\n * @param {!Node} replacementNode\n * @return {void}\n */\nconst replaceNodeInSection = (nodeToReplace, replacementNode) => {\n  if (!nodeToReplace || !replacementNode) {\n    return\n  }\n  let childOfSectionTag = nodeToReplace\n  let sectionTag = nodeToReplace.parentNode\n  if (!sectionTag) {\n    return\n  }\n  let foundSectionTag = false\n  while (sectionTag) {\n    if (SectionUtilities.isMediaWikiSectionElement(sectionTag)) {\n      foundSectionTag = true\n      break\n    }\n    childOfSectionTag = sectionTag\n    sectionTag = sectionTag.parentNode\n  }\n  if (!foundSectionTag) {\n    childOfSectionTag = nodeToReplace\n    sectionTag = nodeToReplace.parentNode\n  }\n  sectionTag.insertBefore(replacementNode, childOfSectionTag)\n  sectionTag.removeChild(childOfSectionTag)\n}\n\n/**\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?string} infoboxTitle\n * @param {?string} otherTitle\n * @param {?string} footerTitle\n * @return {void}\n */\nconst prepareTables = (document, pageTitle, infoboxTitle, otherTitle, footerTitle) => {\n  const tables = document.querySelectorAll('table, .infobox_v3')\n  for (let i = 0; i < tables.length; ++i) {\n    const table = tables[i]\n\n    if (ElementUtilities.findClosestAncestor(table, `.${CLASS.CONTAINER}`)\n      || !shouldTableBeCollapsed(table)) {\n      continue\n    }\n\n    const headerTextArray = getTableHeaderTextArray(document, table, pageTitle)\n    if (!headerTextArray.length && !isInfobox(table)) {\n      continue\n    }\n    const captionFragment =\n      newCaptionFragment(\n        document,\n        isInfobox(table) ? infoboxTitle : otherTitle,\n        isInfobox(table) ? CLASS.TABLE_INFOBOX : CLASS.TABLE_OTHER,\n        headerTextArray)\n\n    // create the container div that will contain both the original table\n    // and the collapsed version.\n    const containerDiv = document.createElement('div')\n    containerDiv.className = CLASS.CONTAINER\n    replaceNodeInSection(table, containerDiv)\n\n    // remove top and bottom margin from the table, so that it's flush with\n    // our expand/collapse buttons\n    table.style.marginTop = '0px'\n    table.style.marginBottom = '0px'\n\n    const collapsedHeaderDiv = newCollapsedHeaderDiv(document, captionFragment)\n    collapsedHeaderDiv.style.display = 'block'\n\n    const collapsedFooterDiv = newCollapsedFooterDiv(document, footerTitle)\n    collapsedFooterDiv.style.display = 'none'\n\n    // add our stuff to the container\n    containerDiv.appendChild(collapsedHeaderDiv)\n    containerDiv.appendChild(table)\n    containerDiv.appendChild(collapsedFooterDiv)\n\n    // set initial visibility\n    table.style.display = 'none'\n  }\n}\n\n/**\n * @param {!Element} container root element to search from\n * @return {void}\n */\nconst toggleCollapsedForAll = container => {\n  const containerDivs = Polyfill.querySelectorAll(container, `.${CLASS.CONTAINER}`)\n  containerDivs.forEach(containerDiv => {\n    toggleCollapsedForContainer(containerDiv)\n  })\n}\n\n/**\n * @param {!Window} window\n * @param {!Element} container root element to search from\n * @param {?boolean} isInitiallyCollapsed\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {void}\n */\nconst setupEventHandling = (window, container, isInitiallyCollapsed, footerDivClickCallback) => {\n  /**\n   * @param {boolean} collapsed\n   * @return {boolean}\n   */\n  const dispatchSectionToggledEvent = collapsed =>\n    window.dispatchEvent(new Polyfill.CustomEvent(SECTION_TOGGLED_EVENT_TYPE, { collapsed }))\n\n  // assign click handler to the collapsed divs\n  const collapsedHeaderDivs = Polyfill.querySelectorAll(container, `.${CLASS.COLLAPSED_CONTAINER}`)\n  collapsedHeaderDivs.forEach(collapsedHeaderDiv => {\n    collapsedHeaderDiv.onclick = () => {\n      const collapsed = toggleCollapseClickCallback.bind(collapsedHeaderDiv)()\n      dispatchSectionToggledEvent(collapsed)\n    }\n  })\n\n  const collapsedFooterDivs = Polyfill.querySelectorAll(container, `.${CLASS.COLLAPSED_BOTTOM}`)\n  collapsedFooterDivs.forEach(collapsedFooterDiv => {\n    collapsedFooterDiv.onclick = () => {\n      const collapsed = toggleCollapseClickCallback.bind(collapsedFooterDiv,\n        footerDivClickCallback)()\n      dispatchSectionToggledEvent(collapsed)\n    }\n  })\n\n  if (!isInitiallyCollapsed) {\n    toggleCollapsedForAll(container)\n  }\n}\n\n/**\n * @param {!Window} window\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?boolean} isMainPage\n * @param {?boolean} isInitiallyCollapsed\n * @param {?string} infoboxTitle\n * @param {?string} otherTitle\n * @param {?string} footerTitle\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {void}\n */\nconst adjustTables = (window, document, pageTitle, isMainPage, isInitiallyCollapsed,\n  infoboxTitle, otherTitle, footerTitle, footerDivClickCallback) => {\n  if (isMainPage) { return }\n\n  prepareTables(document, pageTitle, infoboxTitle, otherTitle, footerTitle)\n  setupEventHandling(window, document, isInitiallyCollapsed, footerDivClickCallback)\n}\n\n/**\n * @param {!Window} window\n * @param {!Document} document\n * @param {?string} pageTitle use title for this not `display title` (which can contain tags)\n * @param {?boolean} isMainPage\n * @param {?string} infoboxTitle\n * @param {?string} otherTitle\n * @param {?string} footerTitle\n * @param {?FooterDivClickCallback} footerDivClickCallback\n * @return {void}\n */\nconst collapseTables = (window, document, pageTitle, isMainPage, infoboxTitle, otherTitle,\n  footerTitle, footerDivClickCallback) => {\n  adjustTables(window, document, pageTitle, isMainPage, true, infoboxTitle, otherTitle,\n    footerTitle, footerDivClickCallback)\n}\n\n/**\n * If you tap a reference targeting an anchor within a collapsed table, this\n * method will expand the references section. The client can then scroll to the\n * references section.\n *\n * The first reference (an \"[A]\") in the \"enwiki > Airplane\" article from ~June\n * 2016 exhibits this issue. (You can copy wikitext from this revision into a\n * test wiki page for testing.)\n * @param  {?Element} element\n * @return {void}\n*/\nconst expandCollapsedTableIfItContainsElement = element => {\n  if (element) {\n    const containerSelector = `[class*=\"${CLASS.CONTAINER}\"]`\n    const container = ElementUtilities.findClosestAncestor(element, containerSelector)\n    if (container) {\n      const collapsedDiv = container.firstElementChild\n      if (collapsedDiv && collapsedDiv.classList.contains(CLASS.EXPANDED)) {\n        collapsedDiv.click()\n      }\n    }\n  }\n}\n\nexport default {\n  CLASS,\n  SECTION_TOGGLED_EVENT_TYPE,\n  toggleCollapsedForAll,\n  toggleCollapseClickCallback,\n  collapseTables,\n  adjustTables,\n  prepareTables,\n  setupEventHandling,\n  expandCollapsedTableIfItContainsElement,\n  test: {\n    elementScopeComparator,\n    extractEligibleHeaderText,\n    firstWordFromString,\n    getTableHeaderTextArray,\n    shouldTableBeCollapsed,\n    isHeaderEligible,\n    isHeaderTextEligible,\n    isInfobox,\n    newCollapsedHeaderDiv,\n    newCollapsedFooterDiv,\n    newCaptionFragment,\n    isNodeTextContentSimilarToPageTitle,\n    stringWithNormalizedWhitespace,\n    replaceNodeWithBreakingSpaceTextNode\n  }\n}","/**\n * get Section Offsets object to handle quick scrolling in the table of contents\n * @param  {!HTMLBodyElement} body HTML body element DOM object.\n * @return {!object} section offsets object\n */\nconst getSectionOffsets = (body: HTMLBodyElement): object => {\n    const sections = Array.from(body.querySelectorAll('section'))\n    return {\n        sections: sections.reduce((results: Array<object>, section: HTMLElement) => {\n            const id = section.getAttribute('data-mw-section-id');\n            const heading = section &&\n                section.firstElementChild &&\n                section.firstElementChild.querySelector('.pagelib_edit_section_title');\n            if (id && parseInt(id) >= 1) {\n                results.push({\n                    heading: heading && heading.innerHTML,\n                    id: parseInt(id),\n                    yOffset: section.offsetTop,\n                });\n            }\n            return results;\n        }, [])\n    }\n}\n\n/**\n * Get section of a given element\n * @param  {!Element} element\n * @return {!Element} section\n */\nconst getSectionOfElement = (element: Element): Element | null => {\n    let current: Element | null = element\n    while (current) {\n        if (isMediaWikiSectionElement(current)) {\n            return current\n        }\n        current = current.parentElement\n    }\n    return null\n}\n\n/**\n * Get section id of a given element\n * @param  {!Element} element\n * @return {!Element} section\n */\nconst getSectionIDOfElement = (element: Element): string | null => {\n    let section = getSectionOfElement(element)\n    return section && (section.getAttribute('data-mw-section-id') || section.id.replace('content_block_', ''))\n}\n\n/**\n * Get lead paragraph text\n * @param  {!Document} document object.\n * @return {!string} lead paragraph text\n */\nconst getLeadParagraphText = (document: Document): string => {\n    let firstParagaphInASection = <HTMLElement>document.querySelector('#content_block_0>p');\n    return firstParagaphInASection && firstParagaphInASection.innerText || '';\n}\n\n\n/**\n * @param {!Element} element - element to test\n * @return {boolean} true if this is a element that represents a MediaWiki section\n */\nconst isMediaWikiSectionElement = (element: Element): boolean => {\n    if (!element) {\n        return false\n    }\n    // mobile-html output has `data-mw-section-id` attributes on section tags\n    if (element.tagName === 'SECTION' && element.getAttribute('data-mw-section-id')) {\n        return true\n    }\n    // The iOS app wraps MobileView sections with a div with the `content_block` class\n    // This should be removed after the iOS app switches to mobile-html\n    if (element.tagName === 'DIV' && element.classList && element.classList.contains('content_block')) {\n        return true\n    }\n    return false\n}\n\nexport default {\n    getSectionIDOfElement,\n    getLeadParagraphText,\n    getSectionOffsets,\n    isMediaWikiSectionElement\n}","// Node is undefined in Node.js\nconst NODE_TYPE = {\n  ELEMENT_NODE: 1,\n  TEXT_NODE: 3\n}\n\n/**\n * Determines if node is either an element or text node.\n * @param  {!Node} node\n * @return {!boolean}\n */\nconst isNodeTypeElementOrText = node =>\n  node.nodeType === NODE_TYPE.ELEMENT_NODE || node.nodeType === NODE_TYPE.TEXT_NODE\n\nexport default {\n  isNodeTypeElementOrText,\n  NODE_TYPE\n}","import './LazyLoadTransform.css'\n// todo: use imports when other modules are TypeScript.\nconst ElementGeometry = require('./ElementGeometry').default\nconst ElementUtilities = require('./ElementUtilities').default\nconst Polyfill = require('./Polyfill').default\n\n// CSS classes used to identify and present lazily loaded images. Placeholders are members of\n// PLACEHOLDER_CLASS and one state class: pending, loading, or error. Images are members of either\n// loading or loaded state classes. Class names should match those in LazyLoadTransform.css.\nconst PLACEHOLDER_CLASS = 'pagelib_lazy_load_placeholder'\nconst PLACEHOLDER_PENDING_CLASS = 'pagelib_lazy_load_placeholder_pending' // Download pending.\nconst PLACEHOLDER_LOADING_CLASS = 'pagelib_lazy_load_placeholder_loading' // Download started.\nconst PLACEHOLDER_ERROR_CLASS = 'pagelib_lazy_load_placeholder_error' // Download failure.\nconst IMAGE_LOADING_CLASS = 'pagelib_lazy_load_image_loading' // Download started.\nconst IMAGE_LOADED_CLASS = 'pagelib_lazy_load_image_loaded' // Download completed.\n\nconst CLASSES = {\n  PLACEHOLDER_CLASS,\n  PLACEHOLDER_PENDING_CLASS,\n  PLACEHOLDER_LOADING_CLASS,\n  PLACEHOLDER_ERROR_CLASS,\n  IMAGE_LOADING_CLASS,\n  IMAGE_LOADED_CLASS\n}\n\n// Attributes copied from images to placeholders via data-* attributes for later restoration. The\n// image's classes and dimensions are also set on the placeholder.\n// The 3 data-* items are used by iOS.\nconst COPY_ATTRIBUTES = ['class', 'style', 'src', 'srcset', 'width', 'height', 'alt',\n  'usemap', 'data-file-width', 'data-file-height', 'data-image-gallery'\n]\n\n// Small images, especially icons, are quickly downloaded and may appear in many places. Lazily\n// loading these images degrades the experience with little gain. Always eagerly load these images.\n// Example: flags in the medal count for the \"1896 Summer Olympics medal table.\"\n// https://en.m.wikipedia.org/wiki/1896_Summer_Olympics_medal_table?oldid=773498394#Medal_count\nconst UNIT_TO_MINIMUM_LAZY_LOAD_SIZE: {[unit in string]?: number} = {\n  px: 50, // https://phabricator.wikimedia.org/diffusion/EMFR/browse/master/includes/MobileFormatter.php;c89f371ea9e789d7e1a827ddfec7c8028a549c12$22\n  ex: 10, // ''\n  em: 5 // 1ex ≈ .5em; https://developer.mozilla.org/en-US/docs/Web/CSS/length#Units\n}\n\n/**\n * Replace an image with a placeholder.\n * @param {!Document} document\n * @param {!HTMLImageElement} image The image to be replaced.\n * @return {!HTMLSpanElement} The placeholder replacing image.\n */\nconst convertImageToPlaceholder = (document: Document, image: HTMLImageElement): HTMLSpanElement => {\n  // There are a number of possible implementations for placeholders including:\n  //\n  // - [MobileFrontend] Replace the original image with a span and replace the span with a new\n  //   downloaded image.\n  //   This option has a good fade-in but has some CSS concerns for the placeholder, particularly\n  //   `max-width`, and causes significant reflows when used with image widening.\n  //\n  // - [Previous] Replace the original image with a span and append a new downloaded image to the\n  //   span.\n  //   This option has the best cross-fading and extensibility but makes duplicating all the CSS\n  //   rules for the appended image impractical.\n  //\n  // - [Previous] Replace the original image's source with a transparent image and update the source\n  //   from a new downloaded image.\n  //   This option has a good fade-in and minimal CSS concerns for the placeholder and image but\n  //   causes significant reflows when used with image widening.\n  //\n  // - [Current] Replace the original image with a couple spans and replace the spans with a new\n  //   downloaded image.\n  //   This option is about the same as MobileFrontend but supports image widening without reflows.\n\n  // Create the root placeholder.\n  const placeholder = document.createElement('span')\n\n  // Copy the image's classes and append the placeholder and current state (pending) classes.\n  if (image.hasAttribute('class')) {\n    placeholder.setAttribute('class', image.getAttribute('class') || '')\n  }\n  placeholder.classList.add(PLACEHOLDER_CLASS)\n  placeholder.classList.add(PLACEHOLDER_PENDING_CLASS)\n\n  // Match the image's width, if specified. If image widening is used, this width will be overridden\n  // by !important priority.\n  const geometry = ElementGeometry.from(image)\n  if (geometry.width) { placeholder.style.setProperty('width', `${geometry.width}`) }\n\n  // Save the image's attributes to data-* attributes for later restoration.\n  ElementUtilities.copyAttributesToDataAttributes(image, placeholder, COPY_ATTRIBUTES)\n\n  // Create a spacer and match the aspect ratio of the original image, if determinable. If image\n  // widening is used, this spacer will scale with the width proportionally.\n  const spacing = document.createElement('span')\n  if (geometry.width && geometry.height) {\n    // Assume units are identical.\n    const ratio = geometry.heightValue / geometry.widthValue\n    spacing.style.setProperty('padding-top', `${ratio * 100}%`)\n  }\n\n  // Append the spacer to the placeholder and replace the image with the placeholder.\n  placeholder.appendChild(spacing)\n  if (image.parentNode) image.parentNode.replaceChild(placeholder, image)\n\n  return placeholder\n}\n\n/**\n * @param {!HTMLImageElement} image The image to be considered.\n * @return {!boolean} true if image download can be deferred, false if image should be eagerly\n *                    loaded.\n */\nconst isLazyLoadable = (image: HTMLImageElement): boolean => {\n  const geometry = ElementGeometry.from(image)\n  if (!geometry.width || !geometry.height) { return true }\n  const minWidth = UNIT_TO_MINIMUM_LAZY_LOAD_SIZE[geometry.widthUnit] || Infinity\n  const minHeight = UNIT_TO_MINIMUM_LAZY_LOAD_SIZE[geometry.heightUnit] || Infinity\n  return geometry.widthValue >= minWidth && geometry.heightValue >= minHeight\n}\n\n/**\n * @param {!Element} element\n * @return {!Array.<HTMLImageElement>} Convertible images descendent from but not including element.\n */\nconst queryLazyLoadableImages = (element: Element): HTMLImageElement[] =>\n  Polyfill.querySelectorAll(element, 'img').filter((image: HTMLImageElement) => isLazyLoadable(image))\n\n/**\n * Convert images with placeholders. The transformation is inverted by calling loadImage().\n * @param {!Document} document\n * @param {!Array.<HTMLImageElement>} images The images to lazily load.\n * @return {!Array.<HTMLSpanElement>} The placeholders replacing images.\n */\nconst convertImagesToPlaceholders = (document: Document, images: HTMLImageElement[]): HTMLSpanElement[] =>\n  images.map(image => convertImageToPlaceholder(document, image))\n\n/**\n * Start downloading image resources associated with a given placeholder and replace the placeholder\n * with a new image element when the download is complete.\n * @param {!Document} document\n * @param {!HTMLSpanElement} placeholder\n * @return {!HTMLImageElement} A new image element.\n */\nconst loadPlaceholder = (document: Document, placeholder: HTMLSpanElement): HTMLImageElement => {\n  placeholder.classList.add(PLACEHOLDER_LOADING_CLASS)\n  placeholder.classList.remove(PLACEHOLDER_PENDING_CLASS)\n\n  const image = document.createElement('img')\n\n  const retryListener = (event: MouseEvent) => { // eslint-disable-line require-jsdoc\n    image.setAttribute('src', image.getAttribute('src') || '')\n    event.stopPropagation()\n    event.preventDefault()\n  }\n\n  // Add the download listener prior to setting the src attribute to avoid missing the load event.\n  image.addEventListener('load', () => {\n    placeholder.removeEventListener('click', retryListener)\n    if (placeholder.parentNode) placeholder.parentNode.replaceChild(image, placeholder)\n    image.classList.add(IMAGE_LOADED_CLASS)\n    image.classList.remove(IMAGE_LOADING_CLASS)\n  }, { once: true })\n\n  image.addEventListener('error', () => {\n    placeholder.classList.add(PLACEHOLDER_ERROR_CLASS)\n    placeholder.classList.remove(PLACEHOLDER_LOADING_CLASS)\n    placeholder.addEventListener('click', retryListener)\n  }, { once: true })\n\n  // Set src and other attributes, triggering a download.\n  ElementUtilities.copyDataAttributesToAttributes(placeholder, image, COPY_ATTRIBUTES)\n\n  // Append to the class list after copying over any preexisting classes.\n  image.classList.add(IMAGE_LOADING_CLASS)\n\n  return image\n}\n\nexport default {\n  CLASSES,\n  PLACEHOLDER_CLASS,\n  queryLazyLoadableImages,\n  convertImagesToPlaceholders,\n  loadPlaceholder\n}","/** Function rate limiter. */\nexport default class Throttle {\n  /**\n   * The function to invoke when not throttled.\n   *\n   * @callback NotThrottledFunction\n   */\n\n  /**\n   * A function wrapped in a Throttle.\n   *\n   * @callback WrappedFunction\n   */\n\n  /**\n   * Wraps a function in a Throttle.\n   * @param {!Window} window\n   * @param {!number} period The nonnegative minimum number of milliseconds between function\n   *                         invocations.\n   * @param {!NotThrottledFunction} funktion\n   * @return {!WrappedFunction}\n   */\n  static wrap(window, period, funktion) {\n    const throttle = new Throttle(window, period, funktion)\n    const throttled = function Throttled() { return throttle.queue(this, arguments) }\n    throttled.result = () => throttle.result\n    throttled.pending = () => throttle.pending()\n    throttled.delay = () => throttle.delay()\n    throttled.cancel = () => throttle.cancel()\n    throttled.reset = () => throttle.reset()\n    return throttled\n  }\n\n  /**\n   * @param {!Window} window\n   * @param {!number} period The nonnegative minimum number of milliseconds between function\n   *                         invocations.\n   * @param {!NotThrottledFunction} funktion\n   */\n  constructor(window, period, funktion) {\n    this._window = window\n    this._period = period\n    this._function = funktion\n\n    // The upcoming invocation's context and arguments.\n    this._context = undefined\n    this._arguments = undefined\n\n    // The previous invocation's result, timeout identifier, and last run timestamp.\n    this._result = undefined\n    this._timeout = 0\n    this._timestamp = 0\n  }\n\n  /**\n   * The return value of the initial run is always undefined. The return value of subsequent runs is\n   * always a previous result. The context and args used by a future invocation are always the most\n   * recently supplied. Invocations, even if immediately eligible, are dispatched.\n   * @param {?any} context\n   * @param {?any} args The arguments passed to the underlying function.\n   * @return {?any} The cached return value of the underlying function.\n   */\n  queue(context, args) {\n    // Always update the this and arguments to the latest supplied.\n    this._context = context\n    this._arguments = args\n\n    if (!this.pending()) {\n      // Queue a new invocation.\n      this._timeout = this._window.setTimeout(() => {\n        this._timeout = 0\n        this._timestamp = Date.now()\n        this._result = this._function.apply(this._context, this._arguments)\n      }, this.delay())\n    }\n\n    // Always return the previous result.\n    return this.result\n  }\n\n  /** @return {?any} The cached return value of the underlying function. */\n  get result() { return this._result }\n\n  /** @return {!boolean} true if an invocation is queued. */\n  pending() { return Boolean(this._timeout) }\n\n  /**\n   * @return {!number} The nonnegative number of milliseconds until an invocation is eligible to\n   *                   run.\n   */\n  delay() {\n    if (!this._timestamp) { return 0 }\n    return Math.max(0, this._period - (Date.now() - this._timestamp))\n  }\n\n  /**\n   * Clears any pending invocation but doesn't clear time last invoked or prior result.\n   * @return {void}\n   */\n  cancel() {\n    if (this._timeout) { this._window.clearTimeout(this._timeout) }\n    this._timeout = 0\n  }\n\n  /**\n   * Clears any pending invocation, time last invoked, and prior result.\n   * @return {void}\n   */\n  reset() {\n    this.cancel()\n    this._result = undefined\n    this._timestamp = 0\n  }\n}","import './FooterContainer.css'\n\n/**\n * Returns a fragment containing structural footer html which may be inserted where needed.\n * @param {!Document} document\n * @return {!DocumentFragment}\n */\nconst containerFragment = document => {\n  const containerFragment = document.createDocumentFragment()\n  const menuSection = document.createElement('section')\n  menuSection.id = 'pagelib_footer_container_menu'\n  menuSection.className = 'pagelib_footer_section'\n  menuSection.innerHTML =\n  `<h2 id='pagelib_footer_container_menu_heading'></h2>\n   <div id='pagelib_footer_container_menu_items'></div>`\n  containerFragment.appendChild(menuSection)\n  const readMoreSection = document.createElement('section')\n  readMoreSection.id = 'pagelib_footer_container_readmore'\n  readMoreSection.className = 'pagelib_footer_section'\n  readMoreSection.innerHTML =\n  `<h2 id='pagelib_footer_container_readmore_heading'></h2>\n   <div id='pagelib_footer_container_readmore_pages'></div>`\n  containerFragment.appendChild(readMoreSection)\n  const legalSection = document.createElement('section')\n  legalSection.id = 'pagelib_footer_container_legal'\n  containerFragment.appendChild(legalSection)\n  return containerFragment\n}\n\n/**\n * Indicates whether container is has already been added.\n * @param {!Document} document\n * @return {boolean}\n */\nconst isContainerAttached = document => Boolean(document.querySelector('#pagelib_footer_container'))\n\nexport default {\n  containerFragment,\n  isContainerAttached // todo: rename isAttached()?\n}","import './FooterLegal.css'\n\n/**\n * @typedef {function} FooterLegalClickCallback\n * @return {void}\n */\n\n/**\n  * @typedef {function} FooterBrowserClickCallback\n  * @return {void}\n  */\n\n/**\n * Adds legal footer html to 'containerID' element.\n * @param {!Element} content\n * @param {?string} licenseString\n * @param {?string} licenseSubstitutionString\n * @param {!string} containerID\n * @param {!FooterLegalClickCallback} licenseLinkClickHandler\n * @param {!string} viewInBrowserString\n * @param {!FooterBrowserClickCallback} browserLinkClickHandler\n * @return {void}\n */\nconst add = (content, licenseString, licenseSubstitutionString, containerID,\n  licenseLinkClickHandler, viewInBrowserString, browserLinkClickHandler) => {\n  // todo: don't manipulate the selector. The client can make this an ID if they want it to be.\n  const container = content.querySelector(`#${containerID}`)\n  const licenseStringHalves = licenseString.split('$1')\n\n  container.innerHTML =\n  `<div class='pagelib_footer_legal_contents'>\n    <hr class='pagelib_footer_legal_divider'>\n    <span class='pagelib_footer_legal_license'>\n      ${licenseStringHalves[0]}\n      <a class='pagelib_footer_legal_license_link'>\n        ${licenseSubstitutionString}\n      </a>\n      ${licenseStringHalves[1]}\n      <br>\n      <div class=\"pagelib_footer_browser\">\n        <a class='pagelib_footer_browser_link'>\n          ${viewInBrowserString}\n        </a>\n      </div>\n    </span>\n  </div>`\n\n  container.querySelector('.pagelib_footer_legal_license_link')\n    .addEventListener('click', () => {\n      licenseLinkClickHandler()\n    })\n\n  container.querySelector('.pagelib_footer_browser_link')\n    .addEventListener('click', () => {\n      browserLinkClickHandler()\n    })\n}\n\nexport default {\n  add\n}","import Polyfill from './Polyfill'\n\n/**\n * Extracts array of page issues from element\n * @param {!Document} document\n * @param {?Element} element\n * @return {!Array.<string>} Return empty array if nothing is extracted\n */\nconst collectPageIssues = (document, element) => {\n  if (!element) {\n    return []\n  }\n  const tables =\n    Polyfill.querySelectorAll(element, 'table.ambox:not(.ambox-multiple_issues):not(.ambox-notice)')\n  // Get the tables into a fragment so we can remove some elements without triggering a layout\n  const fragment = document.createDocumentFragment()\n  const cloneTableIntoFragment =\n    table => fragment.appendChild(table.cloneNode(true)) // eslint-disable-line require-jsdoc\n  tables.forEach(cloneTableIntoFragment)\n  // Remove some elements we don't want when \"textContent\" or \"innerHTML\" are used\n  Polyfill.querySelectorAll(fragment, '.hide-when-compact, .collapsed').forEach(el => el.remove())\n  return Polyfill.querySelectorAll(fragment, 'td[class*=mbox-text] > *[class*=mbox-text]')\n}\n\n/**\n * Extracts array of page issues HTML from element\n * @param {!Document} document\n * @param {?Element} element\n * @return {!Array.<string>} Return empty array if nothing is extracted\n */\nconst collectPageIssuesHTML = (document, element) =>\n  collectPageIssues(document, element).map(el => el.innerHTML)\n\n/**\n * Extracts array of page issues text from element\n * @param {!Document} document\n * @param {?Element} element\n * @return {!Array.<string>} Return empty array if nothing is extracted\n */\nconst collectPageIssuesText = (document, element) =>\n  collectPageIssues(document, element).map(el => el.textContent.trim())\n\n/**\n * Extracts array of disambiguation titles from an element\n * @param {?Element} element\n * @return {!Array.<string>} Return empty array if nothing is extracted\n */\nconst collectDisambiguationTitles = element => {\n  if (!element) {\n    return []\n  }\n  return Polyfill.querySelectorAll(element, 'div.hatnote a[href]:not([href=\"\"]):not([redlink=\"1\"])')\n    .map(el => el.href)\n}\n\n/**\n * Extracts array of disambiguation items html from an element\n * @param {?Element} element\n * @return {!Array.<string>} Return empty array if nothing is extracted\n */\nconst collectDisambiguationHTML = element => {\n  if (!element) {\n    return []\n  }\n  return Polyfill.querySelectorAll(element, 'div.hatnote').map(el => el.innerHTML)\n}\n\nexport default {\n  collectDisambiguationTitles,\n  collectDisambiguationHTML,\n  collectPageIssuesHTML,\n  collectPageIssuesText,\n  test: {\n    collectPageIssues\n  }\n}","import './FooterReadMore.css'\n\n/**\n * @typedef {function} SaveButtonClickHandler\n * @param {!string} title\n * @return {void}\n */\n\n/**\n * @typedef {function} TitlesShownHandler\n * @param {!Array.<string>} titles\n * @return {void}\n */\n\n/**\n * Display fetched read more pages.\n * @typedef {function} ShowReadMorePagesHandler\n * @param {!Array.<object>} pages\n * @param {!string} containerID\n * @param {!SaveButtonClickHandler} saveButtonClickHandler\n * @param {!TitlesShownHandler} titlesShownHandler\n * @param {!Document} document\n * @return {void}\n */\n\nconst SAVE_BUTTON_ID_PREFIX = 'pagelib_footer_read_more_save_'\n\n/**\n * Removes parenthetical enclosures from string.\n * @param {!string} string\n * @param {!string} opener\n * @param {!string} closer\n * @return {!string}\n */\nconst safelyRemoveEnclosures = (string, opener, closer) => {\n  const enclosureRegex = new RegExp(`\\\\s?[${opener}][^${opener}${closer}]+[${closer}]`, 'g')\n  let counter = 0\n  const safeMaxTries = 30\n  let stringToClean = string\n  let previousString = ''\n  do {\n    previousString = stringToClean\n    stringToClean = stringToClean.replace(enclosureRegex, '')\n    counter++\n  } while (previousString !== stringToClean && counter < safeMaxTries)\n  return stringToClean\n}\n\n/**\n * Removes '(...)' and '/.../' parenthetical enclosures from string.\n * @param {!string} string\n * @return {!string}\n */\nconst cleanExtract = string => {\n  let stringToClean = string\n  stringToClean = safelyRemoveEnclosures(stringToClean, '(', ')')\n  stringToClean = safelyRemoveEnclosures(stringToClean, '/', '/')\n  return stringToClean\n}\n\n/**\n * Read more page model.\n */\nclass ReadMorePage {\n  /**\n   * ReadMorePage constructor.\n   * @param {!string} title\n   * @param {!string} displayTitle\n   * @param {?string} thumbnail\n   * @param {?string} description\n   * @param {?string} extract\n   */\n  constructor(title, displayTitle, thumbnail, description, extract) {\n    this.title = title\n    this.displayTitle = displayTitle\n    this.thumbnail = thumbnail\n    this.description = description\n    this.extract = extract\n  }\n}\n\n/**\n * Makes document fragment for a read more page.\n * @param {!ReadMorePage} readMorePage\n * @param {!number} index\n * @param {!SaveButtonClickHandler} saveButtonClickHandler\n * @param {!Document} document\n * @return {!DocumentFragment}\n */\nconst documentFragmentForReadMorePage = (readMorePage, index, saveButtonClickHandler, document) => {\n  const outerAnchorContainer = document.createElement('a')\n  outerAnchorContainer.id = index\n  outerAnchorContainer.className = 'pagelib_footer_readmore_page'\n\n  const hasImage = readMorePage.thumbnail && readMorePage.thumbnail.source\n  if (hasImage) {\n    const image = document.createElement('div')\n    image.style.backgroundImage = `url(${readMorePage.thumbnail.source})`\n    image.classList.add('pagelib_footer_readmore_page_image')\n    outerAnchorContainer.appendChild(image)\n  }\n\n  const innerDivContainer = document.createElement('div')\n  innerDivContainer.classList.add('pagelib_footer_readmore_page_container')\n  outerAnchorContainer.appendChild(innerDivContainer)\n  outerAnchorContainer.href = `./${encodeURI(readMorePage.title)}?event_logging_label=read_more`\n\n  let titleToShow\n  if (readMorePage.displayTitle) {\n    titleToShow = readMorePage.displayTitle\n  } else if (readMorePage.title) {\n    titleToShow = readMorePage.title\n  }\n\n  if (titleToShow) {\n    const title = document.createElement('div')\n    title.id = index\n    title.className = 'pagelib_footer_readmore_page_title'\n    title.innerHTML = titleToShow.replace(/_/g, ' ')\n    outerAnchorContainer.title = readMorePage.title.replace(/_/g, ' ')\n    innerDivContainer.appendChild(title)\n  }\n\n  let description\n  if (readMorePage.description) {\n    description = readMorePage.description\n  }\n  if ((!description || description.length < 10) && readMorePage.extract) {\n    description = cleanExtract(readMorePage.extract)\n  }\n  if (description) {\n    const descriptionEl = document.createElement('div')\n    descriptionEl.id = index\n    descriptionEl.className = 'pagelib_footer_readmore_page_description'\n    descriptionEl.innerHTML = description\n    innerDivContainer.appendChild(descriptionEl)\n  }\n\n  const saveButton = document.createElement('div')\n  saveButton.id = `${SAVE_BUTTON_ID_PREFIX}${encodeURI(readMorePage.title)}`\n  saveButton.className = 'pagelib_footer_readmore_page_save'\n  saveButton.addEventListener('click', event => {\n    event.stopPropagation()\n    event.preventDefault()\n    saveButtonClickHandler(readMorePage.title)\n  })\n  innerDivContainer.appendChild(saveButton)\n\n  return document.createDocumentFragment().appendChild(outerAnchorContainer)\n}\n\n// eslint-disable-next-line valid-jsdoc\n/**\n * @type {ShowReadMorePagesHandler}\n */\nconst showReadMorePages = (pages, containerID, saveButtonClickHandler, titlesShownHandler,\n  document) => {\n  const shownTitles = []\n  const container = document.getElementById(containerID)\n  pages.forEach((page, index) => {\n    const title = page.titles.normalized\n    shownTitles.push(title)\n    const pageModel = new ReadMorePage(title, page.titles.display, page.thumbnail,\n      page.description, page.extract)\n    const pageFragment =\n      documentFragmentForReadMorePage(pageModel, index, saveButtonClickHandler, document)\n    container.appendChild(pageFragment)\n  })\n  titlesShownHandler(shownTitles)\n}\n\n/**\n * URL for retrieving 'Read more' pages for a given title.\n * Leave 'baseURL' null if you don't need to deal with proxying.\n * @param {!string} title\n * @param {!number} count Number of `Read more` items to fetch for this title\n * @param {?string} baseURL\n * @return {!string}\n */\nconst readMoreQueryURL = (title, count, baseURL) =>\n  `${baseURL || ''}/page/related/${title}`\n\n/**\n * Fetch error handler.\n * @param {!string} statusText\n * @return {void}\n */\nconst fetchErrorHandler = statusText => {\n  // TODO: figure out if we want to hide the 'Read more' header in cases when fetch fails.\n  console.log(`statusText = ${statusText}`) // eslint-disable-line no-console\n}\n\n/**\n * Fetches 'Read more' pages.\n * @param {!string} title\n * @param {!number} count\n * @param {!string} containerID\n * @param {?string} baseURL\n * @param {!ShowReadMorePagesHandler} showReadMorePagesHandler\n * @param {!SaveButtonClickHandler} saveButtonClickHandler\n * @param {!TitlesShownHandler} titlesShownHandler\n * @param {!Document} document\n * @return {void}\n */\nconst fetchReadMore = (title, count, containerID, baseURL, showReadMorePagesHandler,\n  saveButtonClickHandler, titlesShownHandler, document) => {\n  const xhr = new XMLHttpRequest() // eslint-disable-line no-undef\n  xhr.open('GET', readMoreQueryURL(title, count, baseURL), true)\n  xhr.onload = () => {\n    if (xhr.readyState === XMLHttpRequest.DONE) { // eslint-disable-line no-undef\n      if (xhr.status === 200) {\n        const pages = JSON.parse(xhr.responseText).pages\n        let results\n        if (pages.length > count) {\n          const rand = Math.floor(Math.random() * Math.floor(pages.length - count))\n          results = pages.slice(rand, rand + count)\n        } else {\n          results = pages\n        }\n        showReadMorePagesHandler(\n          results,\n          containerID,\n          saveButtonClickHandler,\n          titlesShownHandler,\n          document\n        )\n      } else {\n        fetchErrorHandler(xhr.statusText)\n      }\n    }\n  }\n  xhr.onerror = () => fetchErrorHandler(xhr.statusText)\n  try {\n    xhr.send()\n  } catch (error) {\n    fetchErrorHandler(error.toString())\n  }\n}\n\n/**\n * Updates save button bookmark icon for saved state.\n * @param {!HTMLDivElement} button\n * @param {!boolean} isSaved\n * @return {void}\n */\nconst updateSaveButtonBookmarkIcon = (button, isSaved) => {\n  const unfilledClass = 'pagelib_footer_readmore_bookmark_unfilled'\n  const filledClass = 'pagelib_footer_readmore_bookmark_filled'\n  button.classList.remove(filledClass, unfilledClass)\n  button.classList.add(isSaved ? filledClass : unfilledClass)\n}\n\n/**\n * Updates save button text and bookmark icon for saved state.\n * Safe to call even for titles for which there is not currently a 'Read more' item.\n * @param {!string} title\n * @param {!string} text\n * @param {!boolean} isSaved\n * @param {!Document} document\n * @return {void}\n*/\nconst updateSaveButtonForTitle = (title, text, isSaved, document) => {\n  const saveButton = document.getElementById(`${SAVE_BUTTON_ID_PREFIX}${encodeURI(title)}`)\n  if (!saveButton) {\n    return\n  }\n  saveButton.innerText = text\n  saveButton.title = text\n  updateSaveButtonBookmarkIcon(saveButton, isSaved)\n}\n\n/**\n * Adds 'Read more' for 'title' to 'containerID' element.\n * Leave 'baseURL' null if you don't need to deal with proxying.\n * @param {!string} title\n * @param {!number} count\n * @param {!string} containerID\n * @param {?string} baseURL\n * @param {!SaveButtonClickHandler} saveButtonClickHandler\n * @param {!TitlesShownHandler} titlesShownHandler\n * @param {!Document} document\n * @return {void}\n */\nconst add = (title, count, containerID, baseURL, saveButtonClickHandler, titlesShownHandler,\n  document) => {\n  fetchReadMore(\n    title,\n    count,\n    containerID,\n    baseURL,\n    showReadMorePages,\n    saveButtonClickHandler,\n    titlesShownHandler,\n    document\n  )\n}\n\n/**\n * Sets heading element string.\n * @param {!string} headingString\n * @param {!string} headingID\n * @param {!Document} document\n * @return {void}\n */\nconst setHeading = (headingString, headingID, document) => {\n  const headingElement = document.getElementById(headingID)\n  headingElement.innerText = headingString\n  headingElement.title = headingString\n}\n\nexport default {\n  add,\n  setHeading,\n  updateSaveButtonForTitle,\n  test: {\n    cleanExtract,\n    safelyRemoveEnclosures\n  }\n}","/** CSS length value and unit of measure. */\nclass DimensionUnit {\n  /**\n   * Returns the dimension and units of an Element, usually width or height, as specified by inline\n   * style or attribute. This is a pragmatic not bulletproof implementation.\n   * @param {!Element} element\n   * @param {!string} property\n   * @return {?DimensionUnit}\n   */\n  static fromElement(element, property) {\n    return element.style.getPropertyValue(property)\n      && DimensionUnit.fromStyle(element.style.getPropertyValue(property))\n      || element.hasAttribute(property) && new DimensionUnit(element.getAttribute(property))\n      || undefined\n  }\n\n  /**\n   * This is a pragmatic not bulletproof implementation.\n   * @param {!string} property\n   * @return {!DimensionUnit}\n   */\n  static fromStyle(property) {\n    const matches = property.match(/(-?\\d*\\.?\\d*)(\\D+)?/) || []\n    return new DimensionUnit(matches[1], matches[2])\n  }\n\n  /**\n   * @param {!string} value\n   * @param {?string} unit Defaults to pixels.\n   */\n  constructor(value, unit) {\n    this._value = Number(value)\n    this._unit = unit || 'px'\n  }\n\n  /** @return {!number} NaN if unknown. */\n  get value() { return this._value }\n\n  /** @return {!string} */\n  get unit() { return this._unit }\n\n  /** @return {!string} */\n  toString() {\n    return isNaN(this.value) ? '' : `${this.value}${this.unit}`\n  }\n}\n\n/** Element width and height dimensions and units. */\nexport default class ElementGeometry {\n  /**\n   * @param {!Element} element\n   * @return {!ElementGeometry}\n   */\n  static from(element) {\n    return new ElementGeometry(DimensionUnit.fromElement(element, 'width'),\n      DimensionUnit.fromElement(element, 'height'))\n  }\n\n  /**\n   * @param {?DimensionUnit} width\n   * @param {?DimensionUnit} height\n   */\n  constructor(width, height) {\n    this._width = width\n    this._height = height\n  }\n\n  /**\n   * @return {?DimensionUnit}\n   */\n  get width() { return this._width }\n\n  /** @return {!number} NaN if unknown. */\n  get widthValue() { return this._width && !isNaN(this._width.value) ? this._width.value : NaN }\n\n  /** @return {!string} */\n  get widthUnit() { return this._width && this._width.unit || 'px' }\n\n  /**\n   * @return {?DimensionUnit}\n   */\n  get height() { return this._height }\n\n  /** @return {!number} NaN if unknown. */\n  get heightValue() { return this._height && !isNaN(this._height.value) ? this._height.value : NaN }\n\n  /** @return {!string} */\n  get heightUnit() { return this._height && this._height.unit || 'px' }\n}","import './EditTransform.css'\n\nconst CLASS = {\n  SECTION_HEADER: 'pagelib_edit_section_header',\n  TITLE: 'pagelib_edit_section_title',\n  LINK_CONTAINER: 'pagelib_edit_section_link_container',\n  LINK: 'pagelib_edit_section_link',\n  PROTECTION: { UNPROTECTED: '', PROTECTED: 'page-protected', FORBIDDEN: 'no-editing' }\n}\n\nconst IDS = {\n  TITLE_DESCRIPTION: 'pagelib_edit_section_title_description',\n  ADD_TITLE_DESCRIPTION: 'pagelib_edit_section_add_title_description',\n  DIVIDER: 'pagelib_edit_section_divider',\n  PRONUNCIATION: 'pagelib_edit_section_title_pronunciation'\n}\n\nconst DATA_ATTRIBUTE = { SECTION_INDEX: 'data-id', ACTION: 'data-action' }\nconst ACTION_EDIT_SECTION = 'edit_section'\nconst ACTION_TITLE_PRONUNCIATION = 'title_pronunciation'\nconst ACTION_ADD_TITLE_DESCRIPTION = 'add_title_description'\n\n/**\n * Enables edit buttons to be shown (and which ones: protected or regular).\n * @param {!HTMLDocument} document\n * @param {?boolean} isEditable true if edit buttons should be shown\n * @param {?boolean} isProtected true if the protected edit buttons should be shown\n * @return {void}\n */\nconst setEditButtons = (document, isEditable = false, isProtected = false) => {\n  const classList = document.documentElement.classList\n  if (isEditable) {\n    classList.remove(CLASS.PROTECTION.FORBIDDEN)\n  } else {\n    classList.add(CLASS.PROTECTION.FORBIDDEN)\n  }\n  if (isProtected) {\n    classList.add(CLASS.PROTECTION.PROTECTED)\n  } else {\n    classList.remove(CLASS.PROTECTION.PROTECTED)\n  }\n}\n\n/**\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @return {!HTMLAnchorElement}\n */\nconst newEditSectionLink = (document, index) => {\n  const link = document.createElement('a')\n  link.href = ''\n  link.setAttribute(DATA_ATTRIBUTE.SECTION_INDEX, index)\n  link.setAttribute(DATA_ATTRIBUTE.ACTION, ACTION_EDIT_SECTION)\n  link.classList.add(CLASS.LINK)\n  return link\n}\n\n/**\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @return {!HTMLSpanElement}\n */\nconst newEditSectionButton = (document, index) => {\n  const container = document.createElement('span')\n  container.classList.add(CLASS.LINK_CONTAINER)\n\n  const link = newEditSectionLink(document, index)\n  container.appendChild(link)\n\n  return container\n}\n\n/**\n * As a client, you may wish to set the ID attribute.\n * @param {!Document} document\n * @param {!number} index The zero-based index of the section.\n * @param {!number} level The *one-based* header or table of contents level.\n * @param {?string} titleHTML Title of this section header.\n * @param {?boolean} showEditPencil Whether to show the \"edit\" pencil (default is true).\n * @return {!HTMLElement}\n */\nconst newEditSectionHeader = (document, index, level, titleHTML, showEditPencil = true) => {\n  const element = document.createElement('div')\n  element.className = CLASS.SECTION_HEADER\n\n  const title = document.createElement(`h${level}`)\n  title.innerHTML = titleHTML || ''\n  title.className = CLASS.TITLE\n  title.setAttribute(DATA_ATTRIBUTE.SECTION_INDEX, index)\n  element.appendChild(title)\n\n  if (showEditPencil) {\n    const button = newEditSectionButton(document, index)\n    element.appendChild(button)\n  }\n  return element\n}\n\n/**\n * Elements needed to show or add page title description.\n * @param {!Document} document\n * @param {?string} titleDescription Page title description.\n * @param {?string} addTitleDescriptionString Localized string e.g. 'Add title description'.\n * @param {?boolean} isTitleDescriptionEditable Whether title description is editable.\n * @return {?HTMLElement}\n */\nconst titleDescriptionElements = (document, titleDescription, addTitleDescriptionString,\n  isTitleDescriptionEditable) => {\n  const descriptionExists = titleDescription !== undefined && titleDescription.length > 0\n  if (descriptionExists) {\n    const p = document.createElement('p')\n    p.id = IDS.TITLE_DESCRIPTION\n    p.innerHTML = titleDescription\n    return p\n  }\n  if (isTitleDescriptionEditable) {\n    const a = document.createElement('a')\n    a.href = '#'\n    a.setAttribute(DATA_ATTRIBUTE.ACTION, ACTION_ADD_TITLE_DESCRIPTION)\n    const p = document.createElement('p')\n    p.id = IDS.ADD_TITLE_DESCRIPTION\n    p.innerHTML = addTitleDescriptionString\n    a.appendChild(p)\n    return a\n  }\n  return null\n}\n\n/**\n * Lead section header is a special case as it needs to show page title and description too,\n * and in addition to the lead edit pencil, the description can also be editable.\n * As a client, you may wish to set the ID attribute.\n * @param {!Document} document\n * @param {?string} pageDisplayTitle Page display title.\n * @param {?string} titleDescription Page title description.\n * @param {?string} addTitleDescriptionString Localized string e.g. 'Add title description'.\n * @param {?boolean} isTitleDescriptionEditable Whether title description is editable.\n * @param {?boolean} showEditPencil Whether to show the \"edit\" pencil (default is true).\n * @param {?boolean} hasPronunciation Whether to show pronunciation speaker icon (default is false).\n * @return {!HTMLElement}\n */\nconst newEditLeadSectionHeader = (document, pageDisplayTitle, titleDescription,\n  addTitleDescriptionString, isTitleDescriptionEditable, showEditPencil = true,\n  hasPronunciation = false) => {\n\n  const container = document.createDocumentFragment()\n\n  const header = newEditSectionHeader(document, 0, 1, pageDisplayTitle, showEditPencil)\n\n  if (hasPronunciation) {\n    const a = document.createElement('a')\n    a.setAttribute(DATA_ATTRIBUTE.ACTION, ACTION_TITLE_PRONUNCIATION)\n    a.id = IDS.PRONUNCIATION\n    header.querySelector('h1').appendChild(a)\n  }\n\n  container.appendChild(header)\n\n  const descriptionElements = titleDescriptionElements(document, titleDescription,\n    addTitleDescriptionString, isTitleDescriptionEditable)\n\n  if (descriptionElements) {\n    container.appendChild(descriptionElements)\n  }\n\n  const divider = document.createElement('hr')\n  divider.id = IDS.DIVIDER\n  container.appendChild(divider)\n\n  return container\n}\n\nexport default {\n  CLASS,\n  ADD_TITLE_DESCRIPTION: IDS.ADD_TITLE_DESCRIPTION,\n  setEditButtons,\n  newEditSectionButton,\n  newEditSectionHeader,\n  newEditLeadSectionHeader\n}","const CLASS = { ANDROID: 'pagelib_platform_android', IOS:  'pagelib_platform_ios' }\n\n// Regular expressions from https://phabricator.wikimedia.org/diffusion/EMFR/browse/master/resources/mobile.startup/browser.js;c89f371ea9e789d7e1a827ddfec7c8028a549c12.\n/**\n * @param {!Window} window\n * @return {!boolean} true if the user agent is Android, false otherwise.\n */\nconst isAndroid = window => /android/i.test(window.navigator.userAgent)\n\n/**\n * @param {!Window} window\n * @return {!boolean} true if the user agent is iOS, false otherwise.\n */\nconst isIOs = window => /ipad|iphone|ipod/i.test(window.navigator.userAgent)\n\n/**\n * @param {!HTMLDocument} document\n * @param {!string} platform one of the values in CLASS\n * @return {void}\n */\nconst setPlatform = (document, platform) => {\n  document.querySelector('html').classList.add(platform)\n}\n\n/**\n * @param {!Window} window\n * @return {void}\n */\nconst classify = window => {\n  const html = window.document.querySelector('html')\n  if (isAndroid(window)) { html.classList.add(CLASS.ANDROID) }\n  if (isIOs(window)) { html.classList.add(CLASS.IOS) }\n}\n\nexport default {\n  CLASS,\n  classify,\n  setPlatform\n}","import './ThemeTransform.css'\nimport ElementUtilities from './ElementUtilities'\nimport Polyfill from './Polyfill'\n\n// Elements marked with these classes indicate certain ancestry constraints that are\n// difficult to describe as CSS selectors.\nconst CONSTRAINT = {\n  IMAGE_PRESUMES_WHITE_BACKGROUND: 'pagelib_theme_image_presumes_white_background',\n  DIV_DO_NOT_APPLY_BASELINE: 'pagelib_theme_div_do_not_apply_baseline'\n}\n\n// Theme to CSS classes.\nconst THEME = {\n  DEFAULT: 'pagelib_theme_default',\n  DARK: 'pagelib_theme_dark',\n  SEPIA: 'pagelib_theme_sepia',\n  BLACK: 'pagelib_theme_black'\n}\n\n/**\n * @param {!Document} document\n * @param {!string} theme\n * @return {void}\n */\nconst setTheme = (document, theme) => {\n  const html = document.querySelector('html')\n\n  // Set the new theme.\n  html.classList.add(theme)\n\n  // Clear any previous theme.\n  for (const key in THEME) {\n    if (Object.prototype.hasOwnProperty.call(THEME, key) && THEME[key] !== theme) {\n      html.classList.remove(THEME[key])\n    }\n  }\n}\n\n/**\n * Football template image filename regex.\n * https://en.wikipedia.org/wiki/Template:Football_kit/pattern_list\n * @type {RegExp}\n */\nconst footballTemplateImageFilenameRegex =\n  new RegExp('Kit_(body|socks|shorts|right_arm|left_arm)(.*).png$')\n\n/* en > Away colours > 793128975 */\n/* en > Manchester United F.C. > 793244653 */\n/**\n * Determines whether white background should be added to image.\n * @param  {!HTMLImageElement} image\n * @return {!boolean}\n */\nconst imagePresumesWhiteBackground = image => {\n  if (footballTemplateImageFilenameRegex.test(image.src)) {\n    return false\n  }\n  if (image.classList.contains('mwe-math-fallback-image-inline')) {\n    return false\n  }\n  return !ElementUtilities.closestInlineStyle(image, 'background')\n}\n\n/**\n * Annotate elements with CSS classes that can be used by CSS rules. The classes themselves are not\n * theme-dependent so classification only need only occur once after the content is loaded, not\n * every time the theme changes.\n * @param {!Element} element\n * @return {void}\n */\nconst classifyElements = element => {\n  Polyfill.querySelectorAll(element, 'img')\n    .filter(imagePresumesWhiteBackground)\n    .forEach(image => {\n      image.classList.add(CONSTRAINT.IMAGE_PRESUMES_WHITE_BACKGROUND)\n    })\n  /* en > Away colours > 793128975 */\n  /* en > Manchester United F.C. > 793244653 */\n  /* en > Pantone > 792312384 */\n  /* en > Wikipedia:Graphs_and_charts > 801754530 */\n  /* en > PepsiCo > 807406166 */\n  /* en > Lua_(programming_language) > 809310207 */\n  const selector = [\n    'div.color_swatch div',\n    'div[style*=\"position: absolute\"]',\n    'div.barbox table div[style*=\"background:\"]',\n    'div.chart div[style*=\"background-color\"]',\n    'div.chart ul li span[style*=\"background-color\"]',\n    'span.legend-color',\n    'div.mw-highlight span',\n    'code.mw-highlight span',\n    '.BrickChartTemplate div',\n    '.PieChartTemplate div',\n    '.BarChartTemplate div',\n    '.StackedBarTemplate td',\n    '.chess-board div',\n    'span[style*=\"background\"]'\n  ].join()\n  Polyfill.querySelectorAll(element, selector).forEach(element =>\n    element.classList.add(CONSTRAINT.DIV_DO_NOT_APPLY_BASELINE))\n}\n\nexport default {\n  CONSTRAINT,\n  THEME,\n  setTheme,\n  classifyElements\n}","import './FooterMenu.css'\nimport CollectionUtilities from './CollectionUtilities'\n\n/**\n * @typedef {function} FooterMenuItemClickCallback\n * @param {!Array.<string>} payload Important - should return empty array if no payload strings.\n * @return {void}\n */\n\n/**\n * @typedef {number} MenuItemType\n */\n\n/**\n * Type representing kinds of menu items.\n * @enum {MenuItemType}\n */\nconst MenuItemType = {\n  languages: 1,\n  lastEdited: 2,\n  pageIssues: 3,\n  disambiguation: 4,\n  coordinate: 5,\n  talkPage: 6,\n  referenceList: 7,\n}\n\n/**\n * Menu item model.\n */\nclass MenuItem {\n  /**\n   * MenuItem constructor.\n   * @param {!string} title\n   * @param {?string} subtitle\n   * @param {!MenuItemType} itemType\n   * @param {FooterMenuItemClickCallback} clickHandler\n   */\n  constructor(title, subtitle, itemType, clickHandler) {\n    this.title = title\n    this.subtitle = subtitle\n    this.itemType = itemType\n    this.clickHandler = clickHandler\n    this.payload = []\n  }\n\n  /**\n   * Returns icon CSS class for this menu item based on its type.\n   * @return {!string}\n   */\n  iconClass() {\n    switch (this.itemType) {\n    case MenuItemType.languages:\n      return 'pagelib_footer_menu_icon_languages'\n    case MenuItemType.lastEdited:\n      return 'pagelib_footer_menu_icon_last_edited'\n    case MenuItemType.talkPage:\n      return 'pagelib_footer_menu_icon_talk_page'\n    case MenuItemType.pageIssues:\n      return 'pagelib_footer_menu_icon_page_issues'\n    case MenuItemType.disambiguation:\n      return 'pagelib_footer_menu_icon_disambiguation'\n    case MenuItemType.coordinate:\n      return 'pagelib_footer_menu_icon_coordinate'\n    case MenuItemType.referenceList:\n      return 'pagelib_footer_menu_icon_reference_list'\n    default:\n      return ''\n    }\n  }\n\n  /**\n   * Extracts array of page issues, disambiguation titles, etc from element.\n   * @typedef {function} PayloadExtractor\n   * @param {!Document} document\n   * @param {?Element} element\n   * @return {!Array.<string>} Return empty array if nothing is extracted\n   */\n\n  /**\n   * Returns reference to function for extracting payload when this menu item is tapped.\n   * @return {?PayloadExtractor}\n   */\n  payloadExtractor() {\n    switch (this.itemType) {\n    case MenuItemType.pageIssues:\n      return CollectionUtilities.collectPageIssuesText\n    case MenuItemType.disambiguation:\n      // Adapt 'collectDisambiguationTitles' method signature to conform to PayloadExtractor type.\n      return (_, element) => CollectionUtilities.collectDisambiguationTitles(element)\n    default:\n      return undefined\n    }\n  }\n}\n\n/**\n * Makes document fragment for a menu item.\n * @param {!MenuItem} menuItem\n * @param {!Document} document\n * @return {!DocumentFragment}\n */\nconst documentFragmentForMenuItem = (menuItem, document) => {\n  const item = document.createElement('div')\n  item.className = 'pagelib_footer_menu_item'\n\n  const containerAnchor = document.createElement('a')\n  containerAnchor.addEventListener('click', () => {\n    menuItem.clickHandler(menuItem.payload)\n  })\n\n  item.appendChild(containerAnchor)\n\n  if (menuItem.title) {\n    const title = document.createElement('div')\n    title.className = 'pagelib_footer_menu_item_title'\n    title.innerText = menuItem.title\n    containerAnchor.title = menuItem.title\n    containerAnchor.appendChild(title)\n  }\n\n  if (menuItem.subtitle) {\n    const subtitle = document.createElement('div')\n    subtitle.className = 'pagelib_footer_menu_item_subtitle'\n    subtitle.innerText = menuItem.subtitle\n    containerAnchor.appendChild(subtitle)\n  }\n\n  const iconClass = menuItem.iconClass()\n  if (iconClass) {\n    item.classList.add(iconClass)\n  }\n\n  return document.createDocumentFragment().appendChild(item)\n}\n\n/**\n * Adds a MenuItem to a container.\n * @param {!MenuItem} menuItem\n * @param {!string} containerID\n * @param {!Document} document\n * @return {void}\n */\nconst addItem = (menuItem, containerID, document) => {\n  document.getElementById(containerID).appendChild(\n    documentFragmentForMenuItem(menuItem, document)\n  )\n}\n\n/**\n * Conditionally adds a MenuItem to a container.\n * @param {!string} title\n * @param {!string} subtitle\n * @param {!MenuItemType} itemType\n * @param {!string} containerID\n * @param {FooterMenuItemClickCallback} clickHandler\n * @param {!Document} document\n * @return {void}\n */\nconst maybeAddItem = (title, subtitle, itemType, containerID, clickHandler, document) => {\n  const item = new MenuItem(title, subtitle, itemType, clickHandler)\n\n  // Items are not added if they have a payload extractor which fails to extract anything.\n  const extractor = item.payloadExtractor()\n  if (extractor) {\n    item.payload = extractor(document, document.querySelector('section[data-mw-section-id=\"0\"]'))\n    if (item.payload.length === 0) {\n      return\n    }\n  }\n\n  addItem(item, containerID, document)\n}\n\n/**\n * Sets heading element string.\n * @param {!string} headingString\n * @param {!string} headingID\n * @param {!Document} document\n * @return {void}\n */\nconst setHeading = (headingString, headingID, document) => {\n  const headingElement = document.getElementById(headingID)\n  headingElement.innerText = headingString\n  headingElement.title = headingString\n}\n\nexport default {\n  MenuItemType, // todo: rename to just ItemType?\n  setHeading,\n  maybeAddItem\n}","import ElementUtilities from './ElementUtilities'\nimport NodeUtilities from './NodeUtilities'\nimport Polyfill from './Polyfill'\n\nconst REFERENCE_SELECTOR = '.reference, .mw-ref'\nconst CITE_HASH_PREFIX = '#cite_note'\n\n/**\n * Is Citation.\n * @param {!string} href\n * @return {!boolean}\n */\nconst isCitation = href => href.indexOf(CITE_HASH_PREFIX) > -1\n\n/**\n * Determines if node is a text node containing only whitespace.\n * @param {!Node} node\n * @return {!boolean}\n */\nconst isWhitespaceTextNode = node =>\n  Boolean(node) && node.nodeType === Node.TEXT_NODE && Boolean(node.textContent.match(/^\\s+$/))\n\n/**\n * Checks if element has a child anchor with a citation link.\n * @param {!Element} element\n * @return {!boolean}\n */\nconst hasCitationLink = element => {\n  const anchor = element.querySelector('a')\n  return anchor && isCitation(anchor.hash)\n}\n\n/**\n * Get the reference text container.\n * @param {!Document} document\n * @param {!Element} source\n * @return {?HTMLElement}\n */\nconst getRefTextContainer = (document, source) => {\n  const refTextContainerID = source.querySelector('A').getAttribute('href').slice(1)\n  const refTextContainer = document.getElementById(refTextContainerID)\n    || document.getElementById(decodeURIComponent(refTextContainerID))\n\n  return refTextContainer\n}\n\n/**\n * Extract reference text free of backlinks.\n * @param {!Document} document\n * @param {!Element} source\n * @return {!string}\n */\nconst collectRefText = (document, source) => {\n  const refTextContainer = getRefTextContainer(document, source)\n  if (!refTextContainer) {\n    return ''\n  }\n\n  // Clone what we're interested in into a frag so we can easily\n  // remove things without consequence to the 'live' document.\n  const frag = document.createDocumentFragment()\n  const fragDiv = document.createElement('div')\n  frag.appendChild(fragDiv)\n  // eslint-disable-next-line require-jsdoc\n  const cloneNodeIntoFragmentDiv = node => fragDiv.appendChild(node.cloneNode(true))\n  Array.prototype.slice.call(refTextContainer.childNodes)\n    .filter(NodeUtilities.isNodeTypeElementOrText)\n    .forEach(cloneNodeIntoFragmentDiv)\n\n  const removalSelector = 'link, style, sup[id^=cite_ref], .mw-cite-backlink'\n  Polyfill.querySelectorAll(fragDiv, removalSelector)\n    .forEach(node => node.remove())\n\n  return fragDiv.innerHTML.trim()\n}\n\n/**\n * Get closest element to node which has class `reference`. If node itself has class `reference`\n * returns the node.\n * @param {!Node} sourceNode\n * @return {?HTMLElement}\n */\nconst closestReferenceClassElement = sourceNode => {\n  if (Polyfill.matchesSelector(sourceNode, REFERENCE_SELECTOR)) {\n    return sourceNode\n  }\n  return ElementUtilities.findClosestAncestor(sourceNode, REFERENCE_SELECTOR)\n}\n\n/**\n * Reference item model.\n */\nclass ReferenceItem {\n  /**\n   * ReferenceItem constructor.\n   * @param {!string} id\n   * @param {!DOMRect} rect\n   * @param {?string} text\n   * @param {?string} html\n   * @param {?string} href\n   */\n  constructor(id, rect, text, html, href) {\n    this.id = id\n    this.rect = rect\n    this.text = text\n    this.html = html\n    this.href = href\n  }\n}\n\n/**\n * Reference item model.\n */\nclass ReferenceLinkItem {\n  /**\n   * ReferenceLinkItem construtor.\n   * @param {!string} href\n   * @param {?string} text\n   */\n  constructor(href, text) {\n    this.href = href\n    this.text = text\n  }\n}\n\n/**\n * Get node's bounding rect as a plain object.\n * @param {!Node} node\n * @return {!Object<string, number>}\n */\nconst getBoundingClientRectAsPlainObject = node => {\n  const rect = node.getBoundingClientRect()\n  return {\n    top: rect.top,\n    right: rect.right,\n    bottom: rect.bottom,\n    left: rect.left,\n    width: rect.width,\n    height: rect.height,\n    x: rect.x,\n    y: rect.y\n  }\n}\n\n/**\n * Converts node to ReferenceItem.\n * @param {!Document} document\n * @param {!Node} node\n * @return {!ReferenceItem}\n */\nconst referenceItemForNode = (document, node) => new ReferenceItem(\n  closestReferenceClassElement(node).id,\n  getBoundingClientRectAsPlainObject(node),\n  node.textContent,\n  collectRefText(document, node),\n  node.querySelector('A').getAttribute('href')\n)\n\n/**\n * Converts node to ReferenceLinkItem.\n * @param {!Document} document\n * @param {!Node} node\n * @return {!ReferenceItem}\n */\nconst referenceLinkItemForNode = (document, node) => new ReferenceLinkItem(\n  node.querySelector('A').getAttribute('href'),\n  node.textContent\n)\n\n/**\n * Container for nearby references including the index of the selected reference.\n */\nclass NearbyReferences {\n/**\n * @param {!number} selectedIndex\n * @param {!Array.<ReferenceItem>} referencesGroup\n * @return {!NearbyReferences}\n */\n  constructor(selectedIndex, referencesGroup) {\n    this.selectedIndex = selectedIndex\n    this.referencesGroup = referencesGroup\n  }\n}\n\n/**\n * Closure around a node for getting previous or next sibling.\n *\n * @typedef SiblingGetter\n * @param {!Node} node\n * @return {?Node}\n */\n\n/**\n  * Closure around `collectedNodes` for collecting reference nodes.\n  *\n  * @typedef Collector\n  * @param {!Node} node\n  * @return {void}\n  */\n\n/**\n * Get adjacent non-whitespace node.\n * @param {!Node} node\n * @param {!SiblingGetter} siblingGetter\n * @return {?Node}\n */\nconst adjacentNonWhitespaceNode = (node, siblingGetter) => {\n  let currentNode = node\n  do {\n    currentNode = siblingGetter(currentNode)\n  } while (isWhitespaceTextNode(currentNode))\n  return currentNode\n}\n\n/**\n * Collect adjacent reference nodes. The starting node is not collected.\n * @param {!Node} node\n * @param {!SiblingGetter} siblingGetter\n * @param {!Collector} nodeCollector\n * @return {void}\n */\nconst collectAdjacentReferenceNodes = (node, siblingGetter, nodeCollector) => {\n  let currentNode = node\n  while (true) {\n    currentNode = adjacentNonWhitespaceNode(currentNode, siblingGetter)\n    if (!currentNode || currentNode.nodeType !== Node.ELEMENT_NODE\n        || !hasCitationLink(currentNode)) {\n      break\n    }\n    nodeCollector(currentNode)\n  }\n}\n\n/* eslint-disable valid-jsdoc */\n/** @type {SiblingGetter} */\nconst prevSiblingGetter = node => node.previousSibling\n\n/** @type {SiblingGetter} */\nconst nextSiblingGetter = node => node.nextSibling\n/* eslint-enable valid-jsdoc */\n\n/**\n * Collect nearby reference nodes.\n * @param {!Node} sourceNode\n * @return {!Array.<Node>}\n */\nconst collectNearbyReferenceNodes = sourceNode => {\n  const collectedNodes = [sourceNode]\n\n  /* eslint-disable require-jsdoc */\n  // These are `Collector`s.\n  const collectedNodesUnshifter = node => collectedNodes.unshift(node)\n  const collectedNodesPusher = node => collectedNodes.push(node)\n  /* eslint-enable require-jsdoc */\n\n  collectAdjacentReferenceNodes(sourceNode, prevSiblingGetter, collectedNodesUnshifter)\n  collectAdjacentReferenceNodes(sourceNode, nextSiblingGetter, collectedNodesPusher)\n\n  return collectedNodes\n}\n\n/**\n * Collect nearby references.\n * @param {!Document} document\n * @param {!Node} sourceNode\n * @return {!NearbyReferences}\n */\nconst collectNearbyReferences = (document, sourceNode) => {\n  const sourceNodeParent = sourceNode.parentElement\n  const referenceNodes = collectNearbyReferenceNodes(sourceNodeParent)\n  const selectedIndex = referenceNodes.indexOf(sourceNodeParent)\n  const referencesGroup = referenceNodes.map(node => referenceItemForNode(document, node))\n  return new NearbyReferences(selectedIndex, referencesGroup)\n}\n\n/**\n * Collect nearby references.\n * @param {!Document} document\n * @param {!Node} sourceNode\n * @return {!NearbyReferences}\n */\nconst collectNearbyReferencesAsText = (document, sourceNode) => {\n  const sourceNodeParent = sourceNode.parentElement\n  const referenceNodes = collectNearbyReferenceNodes(sourceNodeParent)\n  const selectedIndex = referenceNodes.indexOf(sourceNodeParent)\n  const referencesGroup = referenceNodes.map(node => referenceLinkItemForNode(document, node))\n  return new NearbyReferences(selectedIndex, referencesGroup)\n}\n\nexport default {\n  collectNearbyReferences,\n  collectNearbyReferencesAsText,\n  isCitation,\n  test: {\n    adjacentNonWhitespaceNode,\n    closestReferenceClassElement,\n    collectAdjacentReferenceNodes,\n    collectNearbyReferenceNodes,\n    collectRefText,\n    getRefTextContainer,\n    hasCitationLink,\n    isWhitespaceTextNode,\n    nextSiblingGetter,\n    prevSiblingGetter\n  }\n}","/**\n * Sets text size adjustment percentage of the body element\n * @param  {!HTMLBodyElement} body that needs the margins adjusted.\n * @param  {!string} textSize percentage for text-size-adjust in format of string, like '100%'\n * @return {void}\n */\nconst setPercentage = (body: HTMLBodyElement, textSize: string): void => {\n    if (textSize){\n        // casting body style to avoid errors with the subscript operator and typescript\n        // see https://stackoverflow.com/questions/37655393\n        (<any>body.style)['-webkit-text-size-adjust'] = textSize;\n        (<any>body.style)['text-size-adjust'] = textSize;\n    }\n}\n\n\nexport default {\n    setPercentage\n}","interface Spacing {\n  top?: string\n  right?: string\n  bottom?: string\n  left?: string\n}\n\n/**\n * Sets the margins on an element via inline styles.\n * @param {!HTMLBodyElement} bodyElement the element that needs the margins adjusted.\n *   For the apps this is usually the body element.\n * @param {Spacing} values { top, right, bottom, left }\n *   Use value strings with units, e.g. '16px'. Undefined values are ignored.\n * @return {void}\n */\nconst setMargins = (bodyElement: HTMLBodyElement, values: Spacing): void => {\n  if (values.top !== undefined) {\n    bodyElement.style.marginTop = values.top\n  }\n  if (values.right !== undefined) {\n    bodyElement.style.marginRight = values.right\n  }\n  if (values.bottom !== undefined) {\n    bodyElement.style.marginBottom = values.bottom\n  }\n  if (values.left !== undefined) {\n    bodyElement.style.marginLeft = values.left\n  }\n}\n\n/**\n * Sets padding on an element via inline styles.\n * @param {!HTMLBodyElement} bodyElement the element that needs the padding adjusted.\n *   For the apps this is usually the body element.\n * @param {Spacing} values { top, right, bottom, left }\n *   Use value strings with units, e.g. '16px'. Undefined values are ignored.\n * @return {void}\n */\nconst setPadding = (bodyElement: HTMLBodyElement, values: Spacing): void => {\n  if (values.top !== undefined) {\n    bodyElement.style.paddingTop = values.top\n  }\n  if (values.right !== undefined) {\n    bodyElement.style.paddingRight = values.right\n  }\n  if (values.bottom !== undefined) {\n    bodyElement.style.paddingBottom = values.bottom\n  }\n  if (values.left !== undefined) {\n    bodyElement.style.paddingLeft = values.left\n  }\n}\n\nexport default {\n  setMargins,\n  setPadding\n}","import './DimImagesTransform.css'\nconst CLASS = 'pagelib_dim_images'\n\n/**\n * @param {!Document} document\n * @param {!boolean} enable\n * @return {void}\n */\nconst dimImages = (document, enable) => {\n  document.querySelector('html').classList[enable ? 'add' : 'remove'](CLASS)\n}\n\n/**\n * @deprecated Use dimImages instead, which only requires a Document\n * @param {!Window} window\n * @param {!boolean} enable\n * @return {void}\n */\nconst dim = (window, enable) => dimImages(window.document, enable)\n\n/**\n * @param {!Document} document\n * @return {boolean}\n */\nconst areImagesDimmed = document => document.querySelector('html').classList.contains(CLASS)\n\n/**\n * @deprecated Use areImagesDimmed instead, which only requires a Document\n * @param {!Window} window\n * @return {boolean}\n */\nconst isDim = window => areImagesDimmed(window.document)\n\nexport default {\n  CLASS,\n  dim,\n  isDim,\n  dimImages,\n  areImagesDimmed,\n}","import CollapseTable from './CollapseTable'\nimport ElementUtilities from './ElementUtilities'\nimport LazyLoadTransform from './LazyLoadTransform'\nimport Throttle from './Throttle'\n\nconst EVENT_TYPES = ['scroll', 'resize', CollapseTable.SECTION_TOGGLED_EVENT_TYPE]\nconst THROTTLE_PERIOD_MILLISECONDS = 100\n\n/**\n * This class subscribes to key page events, applying lazy load transforms or inversions as\n * applicable. It has external dependencies on the section-toggled custom event and the following\n * standard browser events: resize, scroll.\n */\nexport default class {\n  /**\n   * @param {!Window} window\n   * @param {!number} loadDistanceMultiplier Images within this multiple of the screen height are\n   *                                         loaded in either direction.\n   */\n  constructor(window, loadDistanceMultiplier) {\n    this._window = window\n    this._loadDistanceMultiplier = loadDistanceMultiplier\n\n    this._placeholders = []\n    this._registered = false\n    this._throttledLoadPlaceholders = Throttle.wrap(window, THROTTLE_PERIOD_MILLISECONDS,\n      () => this._loadPlaceholders())\n  }\n\n  /**\n   * Convert images with placeholders. Calling this function may register this instance to listen to\n   * page events.\n   * @param {!Element} element\n   * @return {void}\n   */\n  convertImagesToPlaceholders(element) {\n    const images = LazyLoadTransform.queryLazyLoadableImages(element)\n    const placeholders = LazyLoadTransform.convertImagesToPlaceholders(this._window.document,\n      images)\n    this._placeholders = this._placeholders.concat(placeholders)\n    this._register()\n  }\n\n  /**\n   * Searches for existing placeholders in the DOM Document.\n   * This is an alternative to #convertImagesToPlaceholders if that was already done server-side.\n   * @param {!Element} element root element to start searching for placeholders\n   * @return {void}\n   */\n  collectExistingPlaceholders(element) {\n    const placeholders\n      = Array.from(element.querySelectorAll(`.${LazyLoadTransform.PLACEHOLDER_CLASS}`))\n    this._placeholders = this._placeholders.concat(placeholders)\n    this._register()\n  }\n\n  /**\n   * Manually trigger a load images check. Calling this function may deregister this instance from\n   * listening to page events.\n   * @return {void}\n   */\n  loadPlaceholders() { this._throttledLoadPlaceholders() }\n\n  /**\n   * This method may be safely called even when already unregistered. This function clears the\n   * record of placeholders.\n   * @return {void}\n   */\n  deregister() {\n    if (!this._registered) { return }\n\n    EVENT_TYPES.forEach(eventType =>\n      this._window.removeEventListener(eventType, this._throttledLoadPlaceholders))\n    this._throttledLoadPlaceholders.reset()\n\n    this._placeholders = []\n    this._registered = false\n  }\n\n  /**\n   * This method may be safely called even when already registered.\n   * @return {void}\n   */\n  _register() {\n    if (this._registered || !this._placeholders.length) { return }\n    this._registered = true\n\n    EVENT_TYPES.forEach(eventType =>\n      this._window.addEventListener(eventType, this._throttledLoadPlaceholders))\n  }\n\n  /** @return {void} */\n  _loadPlaceholders() {\n    this._placeholders = this._placeholders.filter(placeholder => {\n      let pending = true\n      if (this._isPlaceholderEligibleToLoad(placeholder)) {\n        LazyLoadTransform.loadPlaceholder(this._window.document, placeholder)\n        pending = false\n      }\n      return pending\n    })\n\n    if (this._placeholders.length === 0) {\n      this.deregister()\n    }\n  }\n\n  /**\n   * @param {!HTMLSpanElement} placeholder\n   * @return {!boolean}\n   */\n  _isPlaceholderEligibleToLoad(placeholder) {\n    return ElementUtilities.isVisible(placeholder)\n      && this._isPlaceholderWithinLoadDistance(placeholder)\n  }\n\n  /**\n   * @param {!HTMLSpanElement} placeholder\n   * @return {!boolean}\n   */\n  _isPlaceholderWithinLoadDistance(placeholder) {\n    const bounds = placeholder.getBoundingClientRect()\n    const range = this._window.innerHeight * this._loadDistanceMultiplier\n    return !(bounds.top > range || bounds.bottom < -range)\n  }\n}","import FooterContainer from '../../transform/FooterContainer'\nimport FooterLegal from '../../transform/FooterLegal'\nimport FooterMenu from '../../transform/FooterMenu'\nimport FooterReadMore from '../../transform/FooterReadMore'\n\nlet handlers\n\n/**\n * Sets up the interaction handlers for the footer.\n * @param {!{}} newHandlers an object with handlers for {\n *   titlesRetrieved, footerItemSelected, saveOtherPage, viewLicense, viewInBrowser\n * }\n * @return {void}\n */\nconst _connectHandlers = newHandlers => {\n  handlers = newHandlers\n}\n\n/**\n * Adds footer to the end of the document\n * @param {!Object.<any>} params parameters as follows\n *   {!string} title article title for related pages\n *   {!array<string>} menuItems menu items to add\n *   {!map} l10n localized strings\n *   {!number} readMoreItemCount number of read more items to add\n *   {!string} readMoreBaseURL base url for RESTBase to fetch read more\n * @return {void}\n */\nconst add = params => {\n  const { title: articleTitle, menuItems, l10n,\n    readMore: { itemCount: readMoreItemCount, baseURL: readMoreBaseURL } }\n    = params\n\n  // Add container\n  if (FooterContainer.isContainerAttached(document) === false) {\n    document.body.appendChild(FooterContainer.containerFragment(document))\n  }\n  // Add menu\n  FooterMenu.setHeading(\n    l10n.menuHeading,\n    'pagelib_footer_container_menu_heading',\n    document\n  )\n  menuItems.forEach(item => {\n    let title = ''\n    let subtitle = ''\n    let menuItemTypeString = ''\n    switch (item) {\n    case FooterMenu.MenuItemType.languages:\n      menuItemTypeString = 'languages'\n      title = l10n.menuLanguagesTitle\n      break\n    case FooterMenu.MenuItemType.lastEdited:\n      menuItemTypeString = 'lastEdited'\n      title = l10n.menuLastEditedTitle\n      subtitle = l10n.menuLastEditedSubtitle\n      break\n    case FooterMenu.MenuItemType.pageIssues:\n      menuItemTypeString = 'pageIssues'\n      title = l10n.menuPageIssuesTitle\n      break\n    case FooterMenu.MenuItemType.disambiguation:\n      menuItemTypeString = 'disambiguation'\n      title = l10n.menuDisambiguationTitle\n      break\n    case FooterMenu.MenuItemType.coordinate:\n      menuItemTypeString = 'coordinate'\n      title = l10n.menuCoordinateTitle\n      break\n    case FooterMenu.MenuItemType.talkPage:\n      menuItemTypeString = 'talkPage'\n      title = l10n.menuTalkPageTitle\n      break\n    case FooterMenu.MenuItemType.referenceList:\n      menuItemTypeString = 'referenceList'\n      title = l10n.menuReferenceListTitle\n      break\n    default:\n    }\n\n    /**\n     * @param {!map} payload menu item payload\n     * @return {void}\n     */\n    const itemSelectionHandler = payload => {\n      if (handlers) {\n        handlers.footerItemSelected(menuItemTypeString, payload)\n      }\n    }\n\n    FooterMenu.maybeAddItem(\n      title,\n      subtitle,\n      item,\n      'pagelib_footer_container_menu_items',\n      itemSelectionHandler,\n      document\n    )\n  })\n\n  if (readMoreItemCount && readMoreItemCount > 0) {\n    FooterReadMore.setHeading(\n      l10n.readMoreHeading,\n      'pagelib_footer_container_readmore_heading',\n      document\n    )\n\n    /**\n     * @param {!string} title article title\n     * @return {void}\n     */\n    const saveButtonTapHandler = title => {\n      if (handlers) {\n        handlers.saveOtherPage(title)\n      }\n    }\n\n    /**\n     * @param {!list} titles article titles\n     * @return {void}\n     */\n    const titlesShownHandler = titles => {\n      if (handlers) {\n        handlers.titlesRetrieved(titles)\n      }\n    }\n\n    FooterReadMore.add(\n      articleTitle,\n      readMoreItemCount,\n      'pagelib_footer_container_readmore_pages',\n      readMoreBaseURL,\n      saveButtonTapHandler,\n      titlesShownHandler,\n      document\n    )\n  }\n\n  /**\n   * @return {void}\n   */\n  const licenseLinkClickHandler = () => {\n    if (handlers) {\n      handlers.viewLicense()\n    }\n  }\n\n  /**\n   * @return {void}\n   */\n  const viewInBrowserLinkClickHandler = () => {\n    if (handlers) {\n      handlers.viewInBrowser()\n    }\n  }\n\n  FooterLegal.add(\n    document,\n    l10n.licenseString,\n    l10n.licenseSubstitutionString,\n    'pagelib_footer_container_legal',\n    licenseLinkClickHandler,\n    l10n.viewInBrowserString,\n    viewInBrowserLinkClickHandler\n  )\n}\n\n/**\n * Updates save button text and bookmark icon for saved state in 'Read more' items.\n * Safe to call even for titles for which there is not currently a 'Read more' item.\n * @param {!string} title read more entry title\n * @param {!string} text label indicating saved state\n * @param {!boolean} isSaved\n * @return {void}\n */\nconst updateReadMoreSaveButtonForTitle = (title, text, isSaved) => {\n  FooterReadMore.updateSaveButtonForTitle(title, text, isSaved, document)\n}\n\nexport default {\n  MenuItemType: FooterMenu.MenuItemType,\n  add,\n  updateReadMoreSaveButtonForTitle,\n  _connectHandlers // to be used internally only\n}","import CollapseTable from '../../transform/CollapseTable'\nimport EditTransform from '../../transform/EditTransform'\n\nconst selectors = {\n  addTitleDescription: `#${EditTransform.ADD_TITLE_DESCRIPTION}`,\n  tableInfobox: `.${CollapseTable.CLASS.TABLE_INFOBOX}`,\n  tableOther: `.${CollapseTable.CLASS.TABLE_OTHER}`,\n  tableClose: `.${CollapseTable.CLASS.COLLAPSED_BOTTOM}`,\n}\n\n/**\n * Change user visible labels in the WebView.\n * @param {!{string}} localizedStrings a dictionary of localized strings {\n *   addTitleDescription, tableInfobox, tableOther, tableClose\n * }\n * @return {void}\n */\nconst localizeLabels = localizedStrings => {\n  for (const [key, selector] of Object.entries(selectors)) {\n    if (localizedStrings[key]) {\n      const elements = Array.from(document.querySelectorAll(selector))\n      for (const element of elements) {\n        element.innerHTML = localizedStrings[key]\n      }\n    }\n  }\n}\n\nexport default {\n  localizeLabels\n}","let scrollTop = 0\n\n/**\n * Sets the maximum top scroll position in pixel. Use this to adjust for any decor overlaying the\n * Viewport.\n * @param {!number} newValue pixel value\n * @return {void}\n */\nconst setScrollTop = newValue => {\n  scrollTop = newValue\n}\n\n/**\n * Gets maximum top scroll position in pixel.\n * @return {number}\n */\nconst getScrollTop = () => scrollTop\n\n/**\n * Scrolls the WebView to the top of the container parent node.\n * Can be used as FooterDivClickCallback\n * @param {!Element} container\n * @return {void}\n */\nconst scrollWithDecorOffset = container => {\n  window.scrollTo(0, container.parentNode.offsetTop - scrollTop)\n}\n\nexport default {\n  setScrollTop,\n  scrollWithDecorOffset,\n  testing: {\n    getScrollTop\n  }\n}","// Versioned abstraction layer. mobile-html clients are highly encouraged to go through this instead\n// of accessing the other JS functionality directly.\n// c1 stands for PCS client version 1.\n\nimport c1 from './c1'\n\nexport default {\n  c1\n}","import Footer from './Footer'\nimport InteractionHandling from './InteractionHandling'\nimport L10N from './L10N'\nimport Page from './Page'\nimport Platforms from './Platforms'\nimport Scroller from './Scroller'\nimport Sections from './Sections'\nimport Themes from './Themes'\n\nexport default {\n  Footer,\n  InteractionHandling,\n  L10N,\n  Platforms,\n  Page,\n  Scroller,\n  Sections,\n  Themes\n}","import CollapseTable from '../../transform/CollapseTable'\nimport Footer from './Footer'\nimport LazyLoadTransform from '../../transform/LazyLoadTransform'\nimport ReferenceCollection from '../../transform/ReferenceCollection'\nimport SectionUtilities from '../../transform/SectionUtilities'\n\n/**\n * Type of actions users can click which may need to be handled by the native side.\n * @type {!Object}\n */\nconst Actions = {\n  LinkClicked: 'link_clicked',\n  ImageClicked: 'image_clicked',\n  ReferenceClicked: 'reference_clicked',\n  EditSection: 'edit_section',\n  AddTitleDescription: 'add_title_description',\n  PronunciationClicked: 'pronunciation_clicked',\n\n  /* Footer related actions: */\n  FooterItemSelected: 'footer_item_selected',\n  SaveOtherPage: 'save_other_page',\n  ReadMoreTitlesRetrieved: 'read_more_titles_retrieved',\n  ViewLicense: 'view_license',\n  ViewInBrowser: 'view_in_browser',\n}\n\nlet interactionHandler\n\n/**\n * Model of an Interaction.\n */\nclass Interaction {\n  /**\n   * @param {!string} action the type of action\n   * @param {?Object.<any>} data details of the action\n   */\n  constructor(action, data) {\n    this.action = action\n    this.data = data\n  }\n}\n\n/**\n * Type of items users can click which we may need to handle.\n * @type {!Object}\n */\nconst ItemType = {\n  unknown: 0,\n  link: 1,\n  image: 2,\n  imagePlaceholder: 3,\n  reference: 4\n}\n\n/**\n * Model of clicked item.\n * Reminder: separate `target` and `href` properties\n * needed to handle non-anchor targets such as images.\n */\nclass ClickedItem {\n  /**\n   * @param {!EventTarget} target event target\n   * @param {!string} href\n   */\n  constructor(target, href) {\n    this.target = target\n    this.href = href\n  }\n\n  /**\n   * Determines type of item based on its properties.\n   * @return {!ItemType} Type of the item\n   */\n  type() {\n    if (ReferenceCollection.isCitation(this.href)) {\n      return ItemType.reference\n    } else if (this.target.tagName === 'IMG'\n      && (this.target.classList.contains(LazyLoadTransform.CLASSES.IMAGE_LOADED_CLASS)\n          || this.target.classList.contains(LazyLoadTransform.CLASSES.IMAGE_LOADING_CLASS))\n      && (this.target.closest('figure') || this.target.closest('figure-inline'))\n    ) {\n      return ItemType.image\n    } else if (this.target.tagName === 'SPAN'\n      && this.target.classList.contains(LazyLoadTransform.CLASSES.PLACEHOLDER_CLASS)\n      && (this.target.closest('figure') || this.target.closest('figure-inline'))\n    ) {\n      return ItemType.imagePlaceholder\n    } else if (this.href) {\n      return ItemType.link\n    }\n    return ItemType.unknown\n  }\n}\n\n/**\n * Posts a message to native land using the interaction handler.\n * @param {Interaction} interaction the interaction data\n * @return {void}\n */\nconst postMessage = interaction => {\n  interactionHandler(interaction)\n}\n\n/**\n * Posts message for a link click.\n * @param {!Element} target element\n * @param {!string} href url\n * @return {void}\n */\nconst postMessageForLink = (target, href) => {\n  if (href[0] === '#') {\n    CollapseTable.expandCollapsedTableIfItContainsElement(\n      document.getElementById(href.substring(1)))\n  }\n  postMessage(new Interaction(Actions.LinkClicked, {\n    href,\n    text: target.innerText,\n    title: target.title\n  }))\n}\n\n/**\n * Canonical file href\n * @param {!string} href url for the image\n * @return {!string} canonicalized file href\n */\nconst canonicalFileHref = href => href && href.replace(/^\\.\\/.+:/g, './File:')\n\n/**\n * Posts message for an image click.\n * @param {!Element} target an image element\n * @param {!string} href url for the image\n * @return {void}\n */\nconst postMessageForImage = (target, href) => {\n  const canonicalHref = canonicalFileHref(href)\n  postMessage(new Interaction(Actions.ImageClicked, {\n    href: canonicalHref,\n    src: target.getAttribute('src'),\n    'data-file-width': target.getAttribute('data-file-width'),\n    'data-file-height': target.getAttribute('data-file-height')\n  }))\n}\n\n/**\n * Posts a message for a lazy load image placeholder click.\n * @param {!Element} innerPlaceholderSpan\n * @param {!string} href url for the image\n * @return {void}\n */\nconst postMessageForImagePlaceholder = (innerPlaceholderSpan, href) => {\n  const outerSpan = innerPlaceholderSpan.parentElement\n  const canonicalHref = canonicalFileHref(href)\n  postMessage(new Interaction(Actions.ImageClicked, {\n    href: canonicalHref,\n    src: outerSpan.getAttribute('data-src'),\n    'data-file-width': outerSpan.getAttribute('data-data-file-width'),\n    'data-file-height': outerSpan.getAttribute('data-data-file-height')\n  }))\n}\n\n/**\n * Posts a message for a reference click.\n * @param {!Element} target an anchor element\n * @return {void}\n */\nconst postMessageForReferenceWithTarget = target => {\n  const nearbyReferences = ReferenceCollection.collectNearbyReferences(document, target)\n  postMessage(new Interaction(Actions.ReferenceClicked, nearbyReferences))\n}\n\n/**\n * Post messages to native land for respective click types.\n * @param  {!ClickedItem} item the item which was clicked on\n * @return {boolean} `true` if a message was sent, otherwise `false`\n */\nconst postMessageForClickedItem = item => {\n  switch (item.type()) {\n  case ItemType.link:\n    postMessageForLink(item.target, item.href)\n    break\n  case ItemType.image:\n    postMessageForImage(item.target, item.href)\n    break\n  case ItemType.imagePlaceholder:\n    postMessageForImagePlaceholder(item.target, item.href)\n    break\n  case ItemType.reference:\n    postMessageForReferenceWithTarget(item.target)\n    break\n  default:\n    return false\n  }\n  return true\n}\n\n/**\n * Handler for the click event. Posts messages across the JS bridge to native land.\n * @param  {Event} event the event being handled\n * @return {void}\n */\nconst handleClickEvent = event => {\n  const target = event.target\n  if (!target) {\n    return\n  }\n  // Find anchor for non-anchor targets - like images.\n  const anchorForTarget = target.closest('A')\n  if (!anchorForTarget) {\n    return\n  }\n\n  // Handle edit links.\n  if (anchorForTarget.getAttribute('data-action') === 'edit_section') {\n    postMessage(new Interaction(Actions.EditSection,\n      { sectionId: anchorForTarget.getAttribute('data-id') }))\n    return\n  }\n\n  // Handle add title description link.\n  if (anchorForTarget.getAttribute('data-action') === 'add_title_description') {\n    postMessage(new Interaction(Actions.AddTitleDescription))\n    return\n  }\n\n  // Handle audio pronunciation button.\n  if (anchorForTarget.getAttribute('data-action') === 'title_pronunciation') {\n    postMessage(new Interaction(Actions.PronunciationClicked))\n    return\n  }\n\n  const href = anchorForTarget.getAttribute('href')\n  if (!href) {\n    return\n  }\n  postMessageForClickedItem(new ClickedItem(target, href))\n}\n\n/**\n * @param {!string} itemType type of footer menu item\n * @param {!map} payload menu item payload\n * @return {void}\n */\nconst footerItemSelected = (itemType, payload) => {\n  postMessage(new Interaction(Actions.FooterItemSelected, { itemType, payload }))\n}\n\n/**\n * @param {!string} title page title\n * @return {void}\n */\nconst saveOtherPage = title => {\n  postMessage(new Interaction(Actions.SaveOtherPage, { title }))\n}\n\n/**\n * @param {!list<string>} titles list of 'Read more' page titles\n * @return {void}\n */\nconst titlesRetrieved = titles => {\n  postMessage(new Interaction(Actions.ReadMoreTitlesRetrieved, { titles }))\n}\n\n/**\n * @return {void}\n */\nconst viewLicense = () => {\n  postMessage(new Interaction(Actions.ViewLicense))\n}\n\n/**\n * @return {void}\n */\nconst viewInBrowser = () => {\n  postMessage(new Interaction(Actions.ViewInBrowser))\n}\n\n/**\n * Gets information about the current text selection\n * @param {?Window} optionalWindow\n * @return {!map} selection info\n */\nconst getSelectionInfo = optionalWindow => {\n  const selection = (optionalWindow || window).getSelection()\n  const text = selection.toString()\n  const anchorNode = selection.anchorNode\n  const section = SectionUtilities.getSectionIDOfElement(anchorNode)\n  const isTitleDescription = anchorNode &&\n      anchorNode.parentElement &&\n      anchorNode.parentElement.id === 'pagelib_edit_section_title_description' ||\n      false\n  return { text, section, isTitleDescription }\n}\n\n/**\n * Sets the interaction handler function.\n * @param {~Function} myHandlerFunction a platform specific bridge function.\n * On iOS consider using something like:\n *   (interaction) => { window.webkit.messageHandlers.interaction.postMessage(interaction) }\n * On Android consider using something like:\n *   (interaction) => { window.InteractionWebInterface.post(interaction) }\n * To test in a browser consider using something like:\n *   (interaction) => { console.log(JSON.stringify(interaction)) }\n * @return {void}\n */\nconst setInteractionHandler = myHandlerFunction => {\n  interactionHandler = myHandlerFunction\n\n  Footer._connectHandlers({\n    footerItemSelected,\n    saveOtherPage,\n    titlesRetrieved,\n    viewLicense,\n    viewInBrowser\n  })\n\n  // Associate our custom click handler logic with the document `click` event.\n  document.addEventListener('click', event => {\n    event.preventDefault()\n    handleClickEvent(event)\n  }, false)\n}\n\nexport default {\n  Actions,\n  getSelectionInfo,\n  setInteractionHandler\n}","import AdjustTextSize from '../../transform/AdjustTextSize'\nimport BodySpacingTransform from '../../transform/BodySpacingTransform'\nimport CollapseTable from '../../transform/CollapseTable'\nimport DimImagesTransform from '../../transform/DimImagesTransform'\nimport EditTransform from '../../transform/EditTransform'\nimport L10N from './L10N'\nimport LazyLoadTransformer from '../../transform/LazyLoadTransformer'\nimport PlatformTransform from '../../transform/PlatformTransform'\nimport Scroller from './Scroller'\nimport ThemeTransform from '../../transform/ThemeTransform'\n\n/**\n * Executes common JS functionality the client should start, like hooking up events for\n * lazy loading and table collapsing/expanding.\n * Client side complement of server-side DOM transformations.\n * Note: this will be called automatically when DOM is ready\n * @param {!Window} window\n * @param {!Document} document\n * @return {void}\n */\nconst onPageLoad = (window, document) => {\n  CollapseTable.setupEventHandling(window, document, true, Scroller.scrollWithDecorOffset)\n}\n\n/**\n * @typedef {function} OnSuccess\n * @return {void}\n */\n\n/**\n * Makes multiple page modifications based on client specific settings, which should be called\n * during initial page load.\n * @param {?{}} optionalSettings client settings\n *   { platform, clientVersion, l10n, theme, dimImages, margins, areTablesInitiallyExpanded,\n *   scrollTop, textSizeAdjustmentPercentage }\n * @param {?Page~Function} onSuccess callback\n * @return {void}\n */\nconst setup = (optionalSettings, onSuccess) => {\n  const settings = optionalSettings || {}\n  if (settings.platform !== undefined) {\n    PlatformTransform.setPlatform(document, settings.platform)\n  }\n  if (settings.l10n !== undefined) {\n    L10N.localizeLabels(settings.l10n)\n  }\n  if (settings.theme !== undefined) {\n    ThemeTransform.setTheme(document, settings.theme)\n  }\n  if (settings.dimImages !== undefined) {\n    DimImagesTransform.dimImages(document, settings.dimImages)\n  }\n  if (settings.margins !== undefined) {\n    BodySpacingTransform.setMargins(document.body, settings.margins)\n  }\n  if (settings.areTablesInitiallyExpanded) {\n    CollapseTable.toggleCollapsedForAll(document.body)\n  }\n  if (settings.scrollTop !== undefined) {\n    Scroller.setScrollTop(settings.scrollTop)\n  }\n  if (settings.textSizeAdjustmentPercentage !== undefined) {\n    AdjustTextSize.setPercentage(\n      document.body,\n      settings.textSizeAdjustmentPercentage\n    )\n  }\n  if (settings.loadImages === undefined || settings.loadImages === true) {\n    const lazyLoader = new LazyLoadTransformer(window, 2)\n    lazyLoader.collectExistingPlaceholders(document.body)\n    lazyLoader.loadPlaceholders()\n  }\n\n  if (onSuccess instanceof Function) {\n    if (window && window.requestAnimationFrame) {\n      // request animation frame before callback to ensure theme is set\n      window.requestAnimationFrame(() => {\n        onSuccess()\n      })\n    } else {\n      onSuccess()\n    }\n  }\n}\n\n/**\n * Sets the theme.\n * @param {!string} theme one of the values in Themes\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setTheme = (theme, onSuccess) => {\n  ThemeTransform.setTheme(document, theme)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Toggles dimming of images.\n * @param {!boolean} dimImages true if images should be dimmed, false otherwise\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setDimImages = (dimImages, onSuccess) => {\n  DimImagesTransform.dimImages(document, dimImages)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Sets the margins.\n * @param {!{BodySpacingTransform.Spacing}} margins\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setMargins = (margins, onSuccess) => {\n  BodySpacingTransform.setMargins(document.body, margins)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Sets the top scroll position for collapsing of tables (when bottom close button is tapped).\n * @param {!number} scrollTop height of decor covering the top portion of the Viewport in pixel\n * @param {?OnSuccess} onSuccess callback\n * @return {void}\n */\nconst setScrollTop = (scrollTop, onSuccess) => {\n  Scroller.setScrollTop(scrollTop)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Sets text size adjustment percentage of the body element\n * @param  {!string} textSize percentage for text-size-adjust in format of string, like '100%'\n * @param  {?OnSuccess} onSuccess onSuccess callback\n * @return {void}\n */\nconst setTextSizeAdjustmentPercentage = (textSize, onSuccess) => {\n  AdjustTextSize.setPercentage(document.body, textSize)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Enables edit buttons to be shown (and which ones).\n * @param {?boolean} isEditable true if edit buttons should be shown\n * @param {?boolean} isProtected true if the protected edit buttons should be shown\n * @param {?OnSuccess} onSuccess onSuccess callback\n * @return {void}\n */\nconst setEditButtons = (isEditable, isProtected, onSuccess) => {\n  EditTransform.setEditButtons(document, isEditable, isProtected)\n\n  if (onSuccess instanceof Function) {\n    onSuccess()\n  }\n}\n\n/**\n * Gets the revision of the current mobile-html page.\n * @return {string}\n */\nconst getRevision = () => {\n  const about = document.documentElement.getAttribute('about')\n  return about.substring(about.lastIndexOf('/') + 1)\n}\n\n/**\n * Gets the Scroller object. Just for testing!\n * @return {{setScrollTop, scrollWithDecorOffset}}\n */\nconst getScroller = () => Scroller\n\n// automatically invoked when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => onPageLoad(window, document))\n\nexport default {\n  onPageLoad,\n  setup,\n  setTheme,\n  setDimImages,\n  setMargins,\n  setScrollTop,\n  setTextSizeAdjustmentPercentage,\n  setEditButtons,\n  getRevision,\n  testing: {\n    getScroller\n  }\n}","import PlatformTransform from '../../transform/PlatformTransform'\n\nconst Platforms = PlatformTransform.CLASS\n\nexport default {\n  ANDROID: Platforms.ANDROID,\n  IOS: Platforms.IOS\n}","import SectionUtilities from '../../transform/SectionUtilities'\n\nexport default {\n  getOffsets: SectionUtilities.getSectionOffsets,\n}","import ThemeTransform from '../../transform/ThemeTransform'\n\nconst Themes = ThemeTransform.THEME\n\nexport default {\n  DEFAULT: Themes.DEFAULT,\n  DARK: Themes.DARK,\n  SEPIA: Themes.SEPIA,\n  BLACK: Themes.BLACK\n}"],"sourceRoot":""}